/*
Product Name: dhtmlxRibbon 
Version: 4.1.3 
Edition: Standard 
License: content of this file is covered by GPL. Usage outside GPL terms is prohibited. To obtain Commercial or Enterprise license contact sales@dhtmlx.com
Copyright UAB Dinamenta http://www.dhtmlx.com
*/

if(typeof(window.dhx4)=="undefined"){window.dhx4={version:"4.1.3",skin:null,skinDetect:function(a){return{10:"dhx_skyblue",20:"dhx_web",30:"dhx_terrace"}[this.readFromCss(a+"_skin_detect")]||null},readFromCss:function(c,d){var b=document.createElement("DIV");b.className=c;if(document.body.firstChild!=null){document.body.insertBefore(b,document.body.firstChild)}else{document.body.appendChild(b)}var a=b[d||"offsetWidth"];b.parentNode.removeChild(b);b=null;return a},lastId:1,newId:function(){return this.lastId++},zim:{data:{},step:5,first:function(){return 100},last:function(){var c=this.first();for(var b in this.data){c=Math.max(c,this.data[b])}return c},reserve:function(a){this.data[a]=this.last()+this.step;return this.data[a]},clear:function(a){if(this.data[a]!=null){this.data[a]=null;delete this.data[a]}}},s2b:function(a){if(typeof(a)=="string"){a=a.toLowerCase()}return(a==true||a==1||a=="true"||a=="1"||a=="yes"||a=="y")},s2j:function(s){var obj=null;dhx4.temp=null;try{eval("dhx4.temp="+s)}catch(e){dhx4.temp=null}obj=dhx4.temp;dhx4.temp=null;return obj},absLeft:function(a){if(typeof(a)=="string"){a=document.getElementById(a)}return this.getOffset(a).left},absTop:function(a){if(typeof(a)=="string"){a=document.getElementById(a)}return this.getOffset(a).top},_aOfs:function(a){var c=0,b=0;while(a){c=c+parseInt(a.offsetTop);b=b+parseInt(a.offsetLeft);a=a.offsetParent}return{top:c,left:b}},_aOfsRect:function(d){var g=d.getBoundingClientRect();var h=document.body;var b=document.documentElement;var a=window.pageYOffset||b.scrollTop||h.scrollTop;var e=window.pageXOffset||b.scrollLeft||h.scrollLeft;var f=b.clientTop||h.clientTop||0;var i=b.clientLeft||h.clientLeft||0;var j=g.top+a-f;var c=g.left+e-i;return{top:Math.round(j),left:Math.round(c)}},getOffset:function(a){if(a.getBoundingClientRect){return this._aOfsRect(a)}else{return this._aOfs(a)}},_isObj:function(a){return(a!=null&&typeof(a)=="object"&&typeof(a.length)=="undefined")},_copyObj:function(d){if(this._isObj(d)){var c={};for(var b in d){if(typeof(d[b])=="object"&&d[b]!=null){c[b]=this._copyObj(d[b])}else{c[b]=d[b]}}}else{var c=[];for(var b=0;b<d.length;b++){if(typeof(d[b])=="object"&&d[b]!=null){c[b]=this._copyObj(d[b])}else{c[b]=d[b]}}}return c},screenDim:function(){var a=(navigator.userAgent.indexOf("MSIE")>=0);var b={};b.left=document.body.scrollLeft;b.right=b.left+(window.innerWidth||document.body.clientWidth);b.top=Math.max((a?document.documentElement:document.getElementsByTagName("html")[0]).scrollTop,document.body.scrollTop);b.bottom=b.top+(a?Math.max(document.documentElement.clientHeight||0,document.documentElement.offsetHeight||0):window.innerHeight);return b},selectTextRange:function(d,g,b){d=(typeof(d)=="string"?document.getElementById(d):d);var a=d.value.length;g=Math.max(Math.min(g,a),0);b=Math.min(b,a);if(d.setSelectionRange){try{d.setSelectionRange(g,b)}catch(f){}}else{if(d.createTextRange){var c=d.createTextRange();c.moveStart("character",g);c.moveEnd("character",b-a);try{c.select()}catch(f){}}}},transData:null,transDetect:function(){if(this.transData==null){this.transData={transProp:false,transEv:null};var c={MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"transitionend",transition:"transitionend"};for(var b in c){if(this.transData.transProp==false&&document.documentElement.style[b]!=null){this.transData.transProp=b;this.transData.transEv=c[b]}}c=null}return this.transData},_xmlNodeValue:function(a){var c="";for(var b=0;b<a.childNodes.length;b++){c+=(a.childNodes[b].nodeValue!=null?a.childNodes[b].nodeValue.toString().replace(/^[\n\r\s]{0,}/,"").replace(/[\n\r\s]{0,}$/,""):"")}return c}};window.dhx4.isIE=(navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0);window.dhx4.isIE6=(window.XMLHttpRequest==null&&navigator.userAgent.indexOf("MSIE")>=0);window.dhx4.isIE7=(navigator.userAgent.indexOf("MSIE 7.0")>=0&&navigator.userAgent.indexOf("Trident")<0);window.dhx4.isIE8=(navigator.userAgent.indexOf("MSIE 8.0")>=0&&navigator.userAgent.indexOf("Trident")>=0);window.dhx4.isOpera=(navigator.userAgent.indexOf("Opera")>=0);window.dhx4.isChrome=(navigator.userAgent.indexOf("Chrome")>=0);window.dhx4.isKHTML=(navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0);window.dhx4.isFF=(navigator.userAgent.indexOf("Firefox")>=0);window.dhx4.isIPad=(navigator.userAgent.search(/iPad/gi)>=0)}if(typeof(window.dhx4.template)=="undefined"){window.dhx4.trim=function(a){return String(a).replace(/^\s{1,}/,"").replace(/\s{1,}$/,"")};window.dhx4.template=function(b,c,a){return b.replace(/#([a-z0-9_-]{1,})(\|([^#]*))?#/gi,function(){var g=arguments[1];var f=window.dhx4.trim(arguments[3]);var h=null;var e=[c[g]];if(f.length>0){f=f.split(":");var d=[];for(var i=0;i<f.length;i++){if(i>0&&d[d.length-1].match(/\\$/)!=null){d[d.length-1]=d[d.length-1].replace(/\\$/,"")+":"+f[i]}else{d.push(f[i])}}h=d[0];for(var i=1;i<d.length;i++){e.push(d[i])}}if(typeof(h)=="string"&&typeof(window.dhx4.template[h])=="function"){return window.dhx4.template[h].apply(window.dhx4.template,e)}if(g.length>0&&typeof(c[g])!="undefined"){if(a==true){return window.dhx4.trim(c[g])}return String(c[g])}return""})};window.dhx4.template.date=function(a,b){if(a!=null){if(a instanceof Date){return window.dhx4.date2str(a,b)}else{a=a.toString();if(a.match(/^\d*$/)!=null){return window.dhx4.date2str(new Date(parseInt(a)),b)}return a}}return""};window.dhx4.template.maxlength=function(b,a){return String(b).substr(0,a)};window.dhx4.template.number_format=function(d,e,c,a){var b=window.dhx4.template._parseFmt(e,c,a);if(b==false){return d}return window.dhx4.template._getFmtValue(d,b)};window.dhx4.template.lowercase=function(a){if(typeof(a)=="undefined"||a==null){a=""}return String(a).toLowerCase()};window.dhx4.template.uppercase=function(a){if(typeof(a)=="undefined"||a==null){a=""}return String(a).toUpperCase()};window.dhx4.template._parseFmt=function(h,c,a){var d=h.match(/^([^\.\,0-9]*)([0\.\,]*)([^\.\,0-9]*)/);if(d==null||d.length!=4){return false}var b={i_len:false,i_sep:(typeof(c)=="string"?c:","),d_len:false,d_sep:(typeof(a)=="string"?a:"."),s_bef:(typeof(d[1])=="string"?d[1]:""),s_aft:(typeof(d[3])=="string"?d[3]:"")};var g=d[2].split(".");if(g[1]!=null){b.d_len=g[1].length}var e=g[0].split(",");if(e.length>1){b.i_len=e[e.length-1].length}return b};window.dhx4.template._getFmtValue=function(value,fmt){var r=String(value).match(/^(-)?([0-9]{1,})(\.([0-9]{1,}))?$/);if(r!=null&&r.length==5){var v0="";if(r[1]!=null){v0+=r[1]}v0+=fmt.s_bef;if(fmt.i_len!==false){var i=0;var v1="";for(var q=r[2].length-1;q>=0;q--){v1=""+r[2].charAt(q)+v1;if(++i==fmt.i_len&&q>0){v1=fmt.i_sep+v1;i=0}}v0+=v1}else{v0+=r[2]}if(fmt.d_len!==false){if(r[4]==null){r[4]=""}while(r[4].length<fmt.d_len){r[4]+="0"}eval("dhx4.temp = new RegExp(/\\d{"+fmt.d_len+"}/);");var t1=(r[4]).match(dhx4.temp);if(t1!=null){v0+=fmt.d_sep+t1}dhx4.temp=t1=null}v0+=fmt.s_aft;return v0}return value}}if(typeof(window.dhx4.dateLang)=="undefined"){window.dhx4.dateLang="en";window.dhx4.dateStrings={en:{monthFullName:["January","February","March","April","May","June","July","August","September","October","November","December"],monthShortName:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayFullName:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayShortName:["Su","Mo","Tu","We","Th","Fr","Sa"]}};window.dhx4.dateFormat={en:"%Y-%m-%d"};window.dhx4.date2str=function(f,d,a){if(d==null||typeof(d)=="undefnied"){d=window.dhx4.dateFormat[window.dhx4.dateLang]}if(a==null||typeof(a)=="undefnied"){a=window.dhx4.dateStrings[window.dhx4.dateLang]}if(f instanceof Date){var e=function(g){return(String(g).length==1?"0"+String(g):g)};var b=function(i){switch(i){case"%d":return e(f.getDate());case"%j":return f.getDate();case"%D":return a.dayShortName[f.getDay()];case"%l":return a.dayFullName[f.getDay()];case"%m":return e(f.getMonth()+1);case"%n":return f.getMonth()+1;case"%M":return a.monthShortName[f.getMonth()];case"%F":return a.monthFullName[f.getMonth()];case"%y":return e(f.getYear()%100);case"%Y":return f.getFullYear();case"%g":return(f.getHours()+11)%12+1;case"%h":return e((f.getHours()+11)%12+1);case"%G":return f.getHours();case"%H":return e(f.getHours());case"%i":return e(f.getMinutes());case"%s":return e(f.getSeconds());case"%a":return(f.getHours()>11?"pm":"am");case"%A":return(f.getHours()>11?"PM":"AM");case"%%":return"%";case"%u":return f.getMilliseconds();case"%P":if(window.dhx4.temp_calendar!=null&&window.dhx4.temp_calendar.tz!=null){return window.dhx4.temp_calendar.tz}var k=f.getTimezoneOffset();var j=Math.abs(Math.floor(k/60));var g=Math.abs(k)-j*60;return(k>0?"-":"+")+e(j)+":"+e(g);default:return i}};var c=String(d||window.dhx4.dateFormat).replace(/%[a-zA-Z]/g,b)}return(c||String(f))};window.dhx4.str2date=function(g,s,x){if(s==null||typeof(s)=="undefnied"){s=window.dhx4.dateFormat[window.dhx4.dateLang]}if(x==null||typeof(x)=="undefnied"){x=window.dhx4.dateStrings[window.dhx4.dateLang]}s=s.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\\:|]/g,"\\$&");var u=[];var j=[];s=s.replace(/%[a-z]/gi,function(e){switch(e){case"%d":case"%m":case"%y":case"%h":case"%H":case"%i":case"%s":j.push(e);return"(\\d{2})";case"%D":case"%l":case"%M":case"%F":j.push(e);return"([a-zéûä\u0430-\u044F\u0451]{1,})";case"%j":case"%n":case"%g":case"%G":j.push(e);return"(\\d{1,2})";case"%Y":j.push(e);return"(\\d{4})";case"%a":j.push(e);return"([am|pm])";case"%A":j.push(e);return"([AM|PM])";case"%u":j.push(e);return"(\\d{1,6})";case"%P":j.push(e);return"([+-]\\d{1,2}:\\d{1,2})"}return e});var y=new RegExp(s,"i");var l=g.match(y);if(l==null||l.length-1!=j.length){return"Invalid Date"}for(var b=1;b<l.length;b++){u.push(l[b])}var c={"%y":1,"%Y":1,"%n":2,"%m":2,"%M":2,"%F":2,"%d":3,"%j":3,"%a":4,"%A":4,"%H":5,"%G":5,"%h":5,"%g":5,"%i":6,"%s":7,"%u":7,"%P":7};var m={};var i={};for(var b=0;b<j.length;b++){if(typeof(c[j[b]])!="undefined"){var d=c[j[b]];if(!m[d]){m[d]=[];i[d]=[]}m[d].push(u[b]);i[d].push(j[b])}}u=[];j=[];for(var b=1;b<=7;b++){if(m[b]!=null){for(var o=0;o<m[b].length;o++){u.push(m[b][o]);j.push(i[b][o])}}}var a=new Date();a.setDate(1);a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);var n=function(k,e){for(var f=0;f<e.length;f++){if(e[f].toLowerCase()==k){return f}}return -1};for(var b=0;b<u.length;b++){switch(j[b]){case"%d":case"%j":case"%n":case"%m":case"%Y":case"%H":case"%G":case"%i":case"%s":case"%u":if(!isNaN(u[b])){a[{"%d":"setDate","%j":"setDate","%n":"setMonth","%m":"setMonth","%Y":"setFullYear","%H":"setHours","%G":"setHours","%i":"setMinutes","%s":"setSeconds","%u":"setMilliseconds"}[j[b]]](Number(u[b])+(j[b]=="%m"||j[b]=="%n"?-1:0))}break;case"%M":case"%F":var h=n(u[b].toLowerCase(),x[{"%M":"monthShortName","%F":"monthFullName"}[j[b]]]);if(h>=0){a.setMonth(h)}break;case"%y":if(!isNaN(u[b])){var t=Number(u[b]);a.setFullYear(t+(t>50?1900:2000))}break;case"%g":case"%h":if(!isNaN(u[b])){var t=Number(u[b]);if(t<=12&&t>=0){a.setHours(t+(n("pm",u)>=0?(t==12?0:12):(t==12?-12:0)))}}break;case"%P":if(window.dhx4.temp_calendar!=null){window.dhx4.temp_calendar.tz=u[b]}break}}return a}}if(typeof(window.dhx4.ajax)=="undefined"){window.dhx4.ajax={cache:false,method:"get",parse:function(a){if(typeof a!=="string"){return a}a=a.replace(/^[\s]+/,"");if(window.DOMParser&&!dhx4.isIE){var b=(new window.DOMParser()).parseFromString(a,"text/xml")}else{if(window.ActiveXObject!==window.undefined){var b=new window.ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(a)}}return b},xmltop:function(a,c,b){if(typeof c.status=="undefined"||c.status<400){xml=(!c.responseXML)?dhx4.ajax.parse(c.responseText||c):(c.responseXML||c);if(xml&&xml.documentElement!==null&&!xml.getElementsByTagName("parsererror").length){return xml.getElementsByTagName(a)[0]}}if(b!==-1){dhx4.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],b])}return document.createElement("DIV")},xpath:function(c,a){if(!a.nodeName){a=a.responseXML||a}if(dhx4.isIE){return a.selectNodes(c)||[]}else{var d=[];var e;var b=(a.ownerDocument||a).evaluate(c,a,null,XPathResult.ANY_TYPE,null);while(e=b.iterateNext()){d.push(e)}return d}},query:function(a){dhx4.ajax._call((a.method||"GET"),a.url,a.data||"",(a.async||true),a.callback,null,a.headers)},get:function(a,b){this._call("GET",a,null,true,b)},getSync:function(a){return this._call("GET",a,null,false)},put:function(b,a,c){this._call("PUT",b,a,true,c)},del:function(b,a,c){this._call("DELETE",b,a,true,c)},post:function(b,a,c){if(arguments.length==1){a=""}else{if(arguments.length==2&&(typeof(a)=="function"||typeof(window[a])=="function")){c=a;a=""}else{a=String(a)}}this._call("POST",b,a,true,c)},postSync:function(b,a){a=(a==null?"":String(a));return this._call("POST",b,a,false)},getLong:function(a,b){this._call("GET",a,null,true,b,{url:a})},postLong:function(b,a,c){if(arguments.length==2&&(typeof(a)=="function"||typeof(window[a]))){c=a;a=""}this._call("POST",b,a,true,c,{url:b,postData:a})},_call:function(a,b,c,e,g,j,d){var i=(window.XMLHttpRequest&&!dhx4.isIE?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP"));var f=(navigator.userAgent.match(/AppleWebKit/)!=null&&navigator.userAgent.match(/Qt/)!=null&&navigator.userAgent.match(/Safari/)!=null);if(e==true){i.onreadystatechange=function(){if((i.readyState==4)||(f==true&&i.readyState==3)){if(i.status!=200||i.responseText==""){if(!dhx4.callEvent("onAjaxError",[i])){return}}window.setTimeout(function(){if(typeof(g)=="function"){g.apply(window,[{xmlDoc:i}])}if(j!=null){if(typeof(j.postData)!="undefined"){dhx4.ajax.postLong(j.url,j.postData,g)}else{dhx4.ajax.getLong(j.url,g)}}g=null;i=null},1)}}}if(a=="GET"&&this.cache!=true){b+=(b.indexOf("?")>=0?"&":"?")+"dhxr"+new Date().getTime()+"=1"}i.open(a,b,e);if(d){for(var h in d){i.setRequestHeader(h,d[h])}}else{if(a=="POST"||a=="PUT"||a=="DELETE"){i.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}else{if(a=="GET"){c=null}}}i.setRequestHeader("X-Requested-With","XMLHttpRequest");i.send(c);if(!e){return{xmlDoc:i}}}}}if(typeof(window.dhx4._enableDataLoading)=="undefined"){window.dhx4._enableDataLoading=function(g,c,f,e,h){if(h=="clear"){for(var b in g._dhxdataload){g._dhxdataload[b]=null;delete g._dhxdataload[b]}g._loadData=null;g._dhxdataload=null;g.load=null;g.loadStruct=null;g=null;return}g._dhxdataload={initObj:c,xmlToJson:f,xmlRootTag:e,onBeforeXLS:null};g._loadData=function(n,o,p){if(arguments.length==2){p=o;o=null}var m=null;if(arguments.length==3){p=arguments[2]}if(typeof(n)=="string"){var l=n.replace(/^\s{1,}/,"").replace(/\s{1,}$/,"");var s=new RegExp("^<"+this._dhxdataload.xmlRootTag);if(s.test(l.replace(/^<\?xml[^\?]*\?>\s*/,""))){m=dhx4.ajax.parse(n);if(m!=null){m=this[this._dhxdataload.xmlToJson].apply(this,[m])}}if(m==null&&(l.match(/^\{.*\}$/)!=null||l.match(/^\[.*\]$/)!=null)){m=dhx4.s2j(l)}if(m==null){this.callEvent("onXLS",[]);var j=[];if(typeof(this._dhxdataload.onBeforeXLS)=="function"){var l=this._dhxdataload.onBeforeXLS.apply(this,[n]);if(l!=null&&typeof(l)=="object"){if(l.url!=null){n=l.url}if(l.params!=null){for(var q in l.params){j.push(q+"="+encodeURIComponent(l.params[q]))}}}}var r=this;var i=function(a){var k=null;if((a.xmlDoc.getResponseHeader("Content-Type")||"").search(/xml/gi)>=0||(a.xmlDoc.responseText.replace(/^\s{1,}/,"")).match(/^</)!=null){k=r[r._dhxdataload.xmlToJson].apply(r,[a.xmlDoc.responseXML])}else{k=dhx4.s2j(a.xmlDoc.responseText)}if(k!=null){r[r._dhxdataload.initObj].apply(r,[k,n])}r.callEvent("onXLE",[]);if(p!=null){if(typeof(p)=="function"){p.apply(r,[])}else{if(typeof(window[p])=="function"){window[p].apply(r,[])}}}i=p=null;k=a=r=null};j=j.join("&")+(typeof(o)=="string"?"&"+o:"");if(dhx4.ajax.method=="post"){dhx4.ajax.post(n,j,i)}else{if(dhx4.ajax.method=="get"){dhx4.ajax.get(n+(n.indexOf("?")>0?"&":"?")+j,i)}}return}}else{if(typeof(n.documentElement)=="object"||(typeof(n.tagName)!="undefined"&&typeof(n.getElementsByTagName)!="undefined"&&n.getElementsByTagName(this._dhxdataload.xmlRootTag).length>0)){m=this[this._dhxdataload.xmlToJson].apply(this,[n])}else{m=window.dhx4._copyObj(n)}}if(m!=null){this[this._dhxdataload.initObj].apply(this,[m])}if(p!=null){if(typeof(p)=="function"){p.apply(this,[])}else{if(typeof(window[p])=="function"){window[p].apply(this,[])}}p=null}};if(h!=null){var d={struct:"loadStruct",data:"load"};for(var b in h){if(h[b]==true){g[d[b]]=function(){return this._loadData.apply(this,arguments)}}}}g=null}}if(typeof(window.dhx4._eventable)=="undefined"){window.dhx4._eventable=function(a,b){if(b=="clear"){a.detachAllEvents();a.dhxevs=null;a.attachEvent=null;a.detachEvent=null;a.checkEvent=null;a.callEvent=null;a.detachAllEvents=null;a=null;return}a.dhxevs={data:{}};a.attachEvent=function(c,e){c=String(c).toLowerCase();if(!this.dhxevs.data[c]){this.dhxevs.data[c]={}}var d=window.dhx4.newId();this.dhxevs.data[c][d]=e;return d};a.detachEvent=function(f){for(var d in this.dhxevs.data){var e=0;for(var c in this.dhxevs.data[d]){if(c==f){this.dhxevs.data[d][c]=null;delete this.dhxevs.data[d][c]}else{e++}}if(e==0){this.dhxevs.data[d]=null;delete this.dhxevs.data[d]}}};a.checkEvent=function(c){c=String(c).toLowerCase();return(this.dhxevs.data[c]!=null)};a.callEvent=function(d,f){d=String(d).toLowerCase();if(this.dhxevs.data[d]==null){return true}var e=true;for(var c in this.dhxevs.data[d]){e=this.dhxevs.data[d][c].apply(this,f)&&e}return e};a.detachAllEvents=function(){for(var d in this.dhxevs.data){for(var c in this.dhxevs.data[d]){this.dhxevs.data[d][c]=null;delete this.dhxevs.data[d][c]}this.dhxevs.data[d]=null;delete this.dhxevs.data[d]}};a=null};dhx4._eventable(dhx4)}if(typeof(window.dhtmlx)=="undefined"){window.dhtmlx={extend:function(d,c){for(var e in c){if(!d[e]){d[e]=c[e]}}return d},extend_api:function(a,d,c){var b=window[a];if(!b){return}window[a]=function(g){if(g&&typeof g=="object"&&!g.tagName){var f=b.apply(this,(d._init?d._init(g):arguments));for(var e in dhtmlx){if(d[e]){this[d[e]](dhtmlx[e])}}for(var e in g){if(d[e]){this[d[e]](g[e])}else{if(e.indexOf("on")===0){this.attachEvent(e,g[e])}}}}else{var f=b.apply(this,arguments)}if(d._patch){d._patch(this)}return f||this};window[a].prototype=b.prototype;if(c){dhtmlx.extend(window[a].prototype,c)}},url:function(a){if(a.indexOf("?")!=-1){return"&"}else{return"?"}}}}function dhtmlDragAndDropObject(){if(window.dhtmlDragAndDrop){return window.dhtmlDragAndDrop}this.lastLanding=0;this.dragNode=0;this.dragStartNode=0;this.dragStartObject=0;this.tempDOMU=null;this.tempDOMM=null;this.waitDrag=0;window.dhtmlDragAndDrop=this;return this}dhtmlDragAndDropObject.prototype.removeDraggableItem=function(a){a.onmousedown=null;a.dragStarter=null;a.dragLanding=null};dhtmlDragAndDropObject.prototype.addDraggableItem=function(a,b){a.onmousedown=this.preCreateDragCopy;a.dragStarter=b;this.addDragLanding(a,b)};dhtmlDragAndDropObject.prototype.addDragLanding=function(a,b){a.dragLanding=b};dhtmlDragAndDropObject.prototype.preCreateDragCopy=function(a){if((a||window.event)&&(a||event).button==2){return}if(window.dhtmlDragAndDrop.waitDrag){window.dhtmlDragAndDrop.waitDrag=0;document.body.onmouseup=window.dhtmlDragAndDrop.tempDOMU;document.body.onmousemove=window.dhtmlDragAndDrop.tempDOMM;return false}if(window.dhtmlDragAndDrop.dragNode){window.dhtmlDragAndDrop.stopDrag(a)}window.dhtmlDragAndDrop.waitDrag=1;window.dhtmlDragAndDrop.tempDOMU=document.body.onmouseup;window.dhtmlDragAndDrop.tempDOMM=document.body.onmousemove;window.dhtmlDragAndDrop.dragStartNode=this;window.dhtmlDragAndDrop.dragStartObject=this.dragStarter;document.body.onmouseup=window.dhtmlDragAndDrop.preCreateDragCopy;document.body.onmousemove=window.dhtmlDragAndDrop.callDrag;window.dhtmlDragAndDrop.downtime=new Date().valueOf();if((a)&&(a.preventDefault)){a.preventDefault();return false}return false};dhtmlDragAndDropObject.prototype.callDrag=function(c){if(!c){c=window.event}dragger=window.dhtmlDragAndDrop;if((new Date()).valueOf()-dragger.downtime<100){return}if(!dragger.dragNode){if(dragger.waitDrag){dragger.dragNode=dragger.dragStartObject._createDragNode(dragger.dragStartNode,c);if(!dragger.dragNode){return dragger.stopDrag()}dragger.dragNode.onselectstart=function(){return false};dragger.gldragNode=dragger.dragNode;document.body.appendChild(dragger.dragNode);document.body.onmouseup=dragger.stopDrag;dragger.waitDrag=0;dragger.dragNode.pWindow=window;dragger.initFrameRoute()}else{return dragger.stopDrag(c,true)}}if(dragger.dragNode.parentNode!=window.document.body&&dragger.gldragNode){var a=dragger.gldragNode;if(dragger.gldragNode.old){a=dragger.gldragNode.old}a.parentNode.removeChild(a);var b=dragger.dragNode.pWindow;if(a.pWindow&&a.pWindow.dhtmlDragAndDrop.lastLanding){a.pWindow.dhtmlDragAndDrop.lastLanding.dragLanding._dragOut(a.pWindow.dhtmlDragAndDrop.lastLanding)}if(_isIE){var f=document.createElement("Div");f.innerHTML=dragger.dragNode.outerHTML;dragger.dragNode=f.childNodes[0]}else{dragger.dragNode=dragger.dragNode.cloneNode(true)}dragger.dragNode.pWindow=window;dragger.gldragNode.old=dragger.dragNode;document.body.appendChild(dragger.dragNode);b.dhtmlDragAndDrop.dragNode=dragger.dragNode}dragger.dragNode.style.left=c.clientX+15+(dragger.fx?dragger.fx*(-1):0)+(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";dragger.dragNode.style.top=c.clientY+3+(dragger.fy?dragger.fy*(-1):0)+(document.body.scrollTop||document.documentElement.scrollTop)+"px";if(!c.srcElement){var d=c.target}else{d=c.srcElement}dragger.checkLanding(d,c)};dhtmlDragAndDropObject.prototype.calculateFramePosition=function(e){if(window.name){var c=parent.frames[window.name].frameElement.offsetParent;var d=0;var b=0;while(c){d+=c.offsetLeft;b+=c.offsetTop;c=c.offsetParent}if((parent.dhtmlDragAndDrop)){var a=parent.dhtmlDragAndDrop.calculateFramePosition(1);d+=a.split("_")[0]*1;b+=a.split("_")[1]*1}if(e){return d+"_"+b}else{this.fx=d}this.fy=b}return"0_0"};dhtmlDragAndDropObject.prototype.checkLanding=function(b,a){if((b)&&(b.dragLanding)){if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding)}this.lastLanding=b;this.lastLanding=this.lastLanding.dragLanding._dragIn(this.lastLanding,this.dragStartNode,a.clientX,a.clientY,a);this.lastLanding_scr=(_isIE?a.srcElement:a.target)}else{if((b)&&(b.tagName!="BODY")){this.checkLanding(b.parentNode,a)}else{if(this.lastLanding){this.lastLanding.dragLanding._dragOut(this.lastLanding,a.clientX,a.clientY,a)}this.lastLanding=0;if(this._onNotFound){this._onNotFound()}}}};dhtmlDragAndDropObject.prototype.stopDrag=function(b,c){dragger=window.dhtmlDragAndDrop;if(!c){dragger.stopFrameRoute();var a=dragger.lastLanding;dragger.lastLanding=null;if(a){a.dragLanding._drag(dragger.dragStartNode,dragger.dragStartObject,a,(_isIE?event.srcElement:b.target))}}dragger.lastLanding=null;if((dragger.dragNode)&&(dragger.dragNode.parentNode==document.body)){dragger.dragNode.parentNode.removeChild(dragger.dragNode)}dragger.dragNode=0;dragger.gldragNode=0;dragger.fx=0;dragger.fy=0;dragger.dragStartNode=0;dragger.dragStartObject=0;document.body.onmouseup=dragger.tempDOMU;document.body.onmousemove=dragger.tempDOMM;dragger.tempDOMU=null;dragger.tempDOMM=null;dragger.waitDrag=0};dhtmlDragAndDropObject.prototype.stopFrameRoute=function(c){if(c){window.dhtmlDragAndDrop.stopDrag(1,1)}for(var a=0;a<window.frames.length;a++){try{if((window.frames[a]!=c)&&(window.frames[a].dhtmlDragAndDrop)){window.frames[a].dhtmlDragAndDrop.stopFrameRoute(window)}}catch(b){}}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=c)){parent.dhtmlDragAndDrop.stopFrameRoute(window)}}catch(b){}};dhtmlDragAndDropObject.prototype.initFrameRoute=function(c,d){if(c){window.dhtmlDragAndDrop.preCreateDragCopy();window.dhtmlDragAndDrop.dragStartNode=c.dhtmlDragAndDrop.dragStartNode;window.dhtmlDragAndDrop.dragStartObject=c.dhtmlDragAndDrop.dragStartObject;window.dhtmlDragAndDrop.dragNode=c.dhtmlDragAndDrop.dragNode;window.dhtmlDragAndDrop.gldragNode=c.dhtmlDragAndDrop.dragNode;window.document.body.onmouseup=window.dhtmlDragAndDrop.stopDrag;window.waitDrag=0;if(((!_isIE)&&(d))&&((!_isFF)||(_FFrv<1.8))){window.dhtmlDragAndDrop.calculateFramePosition()}}try{if((parent.dhtmlDragAndDrop)&&(parent!=window)&&(parent!=c)){parent.dhtmlDragAndDrop.initFrameRoute(window)}}catch(b){}for(var a=0;a<window.frames.length;a++){try{if((window.frames[a]!=c)&&(window.frames[a].dhtmlDragAndDrop)){window.frames[a].dhtmlDragAndDrop.initFrameRoute(window,((!c||d)?1:0))}}catch(b){}}};_isFF=false;_isIE=false;_isOpera=false;_isKHTML=false;_isMacOS=false;_isChrome=false;_FFrv=false;_KHTMLrv=false;_OperaRv=false;if(navigator.userAgent.indexOf("Macintosh")!=-1){_isMacOS=true}if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){_isChrome=true}if((navigator.userAgent.indexOf("Safari")!=-1)||(navigator.userAgent.indexOf("Konqueror")!=-1)){_KHTMLrv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Safari")+7,5));if(_KHTMLrv>525){_isFF=true;_FFrv=1.9}else{_isKHTML=true}}else{if(navigator.userAgent.indexOf("Opera")!=-1){_isOpera=true;_OperaRv=parseFloat(navigator.userAgent.substr(navigator.userAgent.indexOf("Opera")+6,3))}else{if(navigator.appName.indexOf("Microsoft")!=-1){_isIE=true;if((navigator.appVersion.indexOf("MSIE 8.0")!=-1||navigator.appVersion.indexOf("MSIE 9.0")!=-1||navigator.appVersion.indexOf("MSIE 10.0")!=-1||document.documentMode>7)&&document.compatMode!="BackCompat"){_isIE=8}}else{if(navigator.appName=="Netscape"&&navigator.userAgent.indexOf("Trident")!=-1){_isIE=8}else{_isFF=true;_FFrv=parseFloat(navigator.userAgent.split("rv:")[1])}}}}if(typeof(window.dhtmlxEvent)=="undefined"){function dhtmlxEvent(b,c,a){if(b.addEventListener){b.addEventListener(c,a,false)}else{if(b.attachEvent){b.attachEvent("on"+c,a)}}}}if(dhtmlxEvent.touchDelay==null){dhtmlxEvent.touchDelay=2000}if(typeof(dhtmlxEvent.initTouch)=="undefined"){dhtmlxEvent.initTouch=function(){var d;var e;var b,a;dhtmlxEvent(document.body,"touchstart",function(f){e=f.touches[0].target;b=f.touches[0].clientX;a=f.touches[0].clientY;d=window.setTimeout(c,dhtmlxEvent.touchDelay)});function c(){if(e){var f=document.createEvent("HTMLEvents");f.initEvent("dblclick",true,true);e.dispatchEvent(f);d=e=null}}dhtmlxEvent(document.body,"touchmove",function(f){if(d){if(Math.abs(f.touches[0].clientX-b)>50||Math.abs(f.touches[0].clientY-a)>50){window.clearTimeout(d);d=e=false}}});dhtmlxEvent(document.body,"touchend",function(f){if(d){window.clearTimeout(d);d=e=false}});dhtmlxEvent.initTouch=function(){}}}function dhtmlXCellObject(c,a){this.cell=document.createElement("DIV");this.cell.className="dhx_cell"+(a||"");this._idd=c;this._isCell=true;this.conf={borders:true,idx:{},css:a||"",idx_data:{cont:"dhx_cell_cont",pr1:"dhx_cell_progress_bar",pr2:"dhx_cell_progress_img",menu:"dhx_cell_menu",toolbar:"dhx_cell_toolbar",ribbon:"dhx_cell_ribbon",sb:"dhx_cell_statusbar"},ofs_nodes:{t:{},b:{}}};this.dataNodes={};this.views={};var b=document.createElement("DIV");b.className="dhx_cell_cont"+this.conf.css;this.cell.appendChild(b);b=null;this._updateIdx=function(){for(var d in this.conf.idx){this.conf.idx[d]=null;delete this.conf.idx[d]}for(var g=0;g<this.cell.childNodes.length;g++){var e=this.cell.childNodes[g].className;for(var d in this.conf.idx_data){var f=new RegExp(this.conf.idx_data[d]);if(e.match(f)!=null){this.conf.idx[d]=g}}}this.callEvent("_onIdxUpdated",[])};this._adjustAttached=function(){for(var d in this.dataNodes){if(this.dataNodes[d]!=null&&typeof(this.dataNodes[d].setSizes)=="function"){this.dataNodes[d].setSizes()}}if(this.dataObj!=null&&typeof(this.dataObj.setSizes)=="function"){if(this.dataType=="layout"&&typeof(window.dhtmlXLayoutCell)!="undefined"&&this instanceof window.dhtmlXLayoutCell&&this.dataObj._getMainInst()!=this.layout._getMainInst()){this.dataObj.setSizes();return}this.dataObj.setSizes.apply(this.dataObj,arguments)}};this._setSize=function(m,k,n,g,i,j,e,f){if(this.conf.size==null){this.conf.size={}}if(f==null){f={}}var o={left:"x",top:"y",width:"w",height:"h"};this.conf.size.x=m;this.conf.size.y=k;this.conf.size.w=Math.max(n,0);this.conf.size.h=Math.max(g,0);for(var l in o){var d=(f[l]||l);this.cell.style[d]=this.conf.size[o[l]]+"px"}this.callEvent("_onSetSize",[]);if(j!==true){this._adjustCont(i,e)}else{this._adjustAttached(i)}this._adjustProgress()};this._adjustCont=function(i,g){var h=this.cell.childNodes[this.conf.idx.cont];var f=0;for(var d in this.conf.ofs_nodes.t){var e=this.conf.ofs_nodes.t[d];f+=(e=="func"?this[d]():(e==true?this.cell.childNodes[this.conf.idx[d]].offsetHeight:0))}var j=0;for(var d in this.conf.ofs_nodes.b){var e=this.conf.ofs_nodes.b[d];j+=(e=="func"?this[d]():(e==true?this.cell.childNodes[this.conf.idx[d]].offsetHeight:0))}h.style.left="0px";h.style.top=f+"px";if(!this.conf.cells_cont){this.conf.cells_cont={};h.style.width=this.cell.offsetWidth+"px";h.style.height=Math.max(this.cell.offsetHeight-f-j,0)+"px";this.conf.cells_cont.w=parseInt(h.style.width)-h.offsetWidth;this.conf.cells_cont.h=parseInt(h.style.height)-h.offsetHeight}h.style.left="0px";h.style.top=f+"px";h.style.width=Math.max(this.cell.offsetWidth+this.conf.cells_cont.w,0)+"px";h.style.height=Math.max(this.conf.size.h-f-j+this.conf.cells_cont.h,0)+"px";h=null;this._adjustAttached(i);if(g=="expand"&&this.dataType=="editor"&&this.dataObj!=null){this.dataObj._prepareContent(true)}};this._mtbUpdBorder=function(){var e=["menu","toolbar"];for(var g=0;g<e.length;g++){if(this.conf.idx[e[g]]!=null){var h=this.cell.childNodes[this.conf.idx[e[g]]];var f="dhx_cell_"+e[g]+"_no_borders";var d="dhx_cell_"+e[g]+"_def";h.className=h.className.replace(new RegExp(this.conf.borders?f:d),this.conf.borders?d:f);h=null}}};this._resetSizeState=function(){this.conf.cells_cont=null};this.conf.view="def";this.conf.views_loaded={};this.conf.views_loaded[this.conf.view]=true;this._viewSave=function(f){this.views[f]={borders:this.conf.borders,ofs_nodes:{t:{},b:{}},dataType:this.dataType,dataObj:this.dataObj,cellCont:[],dataNodes:{},dataNodesCont:{}};var g=this.cell.childNodes[this.conf.idx.cont];while(g.childNodes.length>0){this.views[f].cellCont.push(g.firstChild);g.removeChild(g.firstChild)}this.dataType=null;this.dataObj=null;for(var e in this.dataNodes){for(var d in this.conf.ofs_nodes){if(typeof(this.conf.ofs_nodes[d][e])!="undefined"){this.views[f].ofs_nodes[d][e]=this.conf.ofs_nodes[d][e];this.conf.ofs_nodes[d][e]=null;delete this.conf.ofs_nodes[d][e]}}this.views[f].dataNodesCont[e]=this.cell.childNodes[this.conf.idx[e]];this.cell.removeChild(this.cell.childNodes[this.conf.idx[e]]);this.views[f].dataNodes[e]=this.dataNodes[e];this.dataNodes[e]=null;delete this.dataNodes[e];this._updateIdx()}this.callEvent("_onViewSave",[f])};this._viewRestore=function(f){if(this.views[f]==null){return}this.dataObj=this.views[f].dataObj;this.dataType=this.views[f].dataType;for(var g=0;g<this.views[f].cellCont.length;g++){this.cell.childNodes[this.conf.idx.cont].appendChild(this.views[f].cellCont[g])}for(var e in this.views[f].dataNodes){this.dataNodes[e]=this.views[f].dataNodes[e];if(e=="menu"){this.cell.insertBefore(this.views[f].dataNodesCont[e],this.cell.childNodes[this.conf.idx.toolbar||this.conf.idx.cont])}if(e=="toolbar"){this.cell.insertBefore(this.views[f].dataNodesCont[e],this.cell.childNodes[this.conf.idx.cont])}if(e=="sb"){this.cell.appendChild(this.views[f].dataNodesCont[e])}this._updateIdx()}for(var e in this.views[f].ofs_nodes){for(var d in this.views[f].ofs_nodes[e]){this.conf.ofs_nodes[e][d]=this.views[f].ofs_nodes[e][d]}}if(this.conf.borders!=this.views[f].borders){this[this.views[f].borders?"_showBorders":"_hideBorders"](true)}this.callEvent("_onViewRestore",[f]);this._viewDelete(f)};this._viewDelete=function(f){if(this.views[f]==null){return}this.views[f].borders=null;for(var e in this.views[f].ofs_nodes){for(var d in this.views[f].ofs_nodes[e]){this.views[f].ofs_nodes[e][d]=null}this.views[f].ofs_nodes[e]=null}this.views[f].dataType=null;this.views[f].dataObj=null;for(var g=0;g<this.views[f].cellCont.length;g++){this.views[f].cellCont[g]=null}this.views[f].cellCont=null;for(var e in this.views[f].dataNodes){this.views[f].dataNodes[e]=null;this.views[f].dataNodesCont[e]=null}this.views[f].dataNodes=this.views[f].dataNodesCont=null;this.views[f]=null;delete this.views[f]};window.dhx4._eventable(this);this._updateIdx();return this}dhtmlXCellObject.prototype.showView=function(a){if(this.conf.view==a){return false}this._viewSave(this.conf.view);this._viewRestore(a);this._updateIdx();this._adjustCont();this.conf.view=a;var b=(typeof(this.conf.views_loaded[this.conf.view])=="undefined");this.conf.views_loaded[this.conf.view]=true;return b};dhtmlXCellObject.prototype.getViewName=function(){return this.conf.view};dhtmlXCellObject.prototype.unloadView=function(d){if(d==this.conf.view){var e=this.conf.unloading;this.conf.unloading=true;if(typeof(this.detachMenu)=="function"){this.detachMenu()}if(typeof(this.detachToolbar)=="function"){this.detachToolbar()}if(typeof(this.detachRibbon)=="function"){this.detachRibbon()}this.detachStatusBar();this._detachObject(null,true);this.conf.unloading=e;if(!this.conf.unloading){this._adjustCont(this._idd)}return}if(this.views[d]==null){return}var c=this.views[d];for(var b in c.dataNodes){if(typeof(c.dataNodes[b].unload)=="function"){c.dataNodes[b].unload()}c.dataNodes[b]=null;c.dataNodesCont[b]=null}if(c.dataType=="url"){if(c.cellCont!=null&&c.cellCont[0]!="null"){this._detachURLEvents(c.cellCont[0])}}else{if(c.dataObj!=null){if(typeof(c.dataObj.unload)=="function"){c.dataObj.unload()}else{if(typeof(c.dataObj.destructor)=="function"){c.dataObj.destructor()}}c.dataObj=null}}c=null;this._viewDelete(d);if(typeof(this.conf.views_loaded[d])!="undefined"){delete this.conf.views_loaded[d]}};dhtmlXCellObject.prototype.getId=function(){return this._idd};dhtmlXCellObject.prototype.progressOn=function(){if(this.conf.progress){return}this.conf.progress=true;var b=document.createElement("DIV");b.className="dhx_cell_progress_bar";this.cell.appendChild(b);var a=document.createElement("DIV");a.className="dhx_cell_progress_img";this.cell.appendChild(a);b=a=null;this._updateIdx();this._adjustProgress()};dhtmlXCellObject.prototype.progressOff=function(){if(!this.conf.progress){return}this.cell.childNodes[this.conf.idx.pr2].parentNode.removeChild(this.cell.childNodes[this.conf.idx.pr2]);this.cell.childNodes[this.conf.idx.pr1].parentNode.removeChild(this.cell.childNodes[this.conf.idx.pr1]);this.conf.progress=false;this._updateIdx()};dhtmlXCellObject.prototype._adjustProgress=function(){if(this.conf.idx.pr1==null){return}if(!this.conf.pr){this.conf.pr={}}var b=this.cell.childNodes[this.conf.idx.pr1];var a=this.cell.childNodes[this.conf.idx.pr2];if(!this.conf.pr.ofs){a.style.width=b.offsetWidth+"px";a.style.height=b.offsetHeight+"px";this.conf.pr.ofs={w:a.offsetWidth-a.clientWidth,h:a.offsetHeight-a.clientHeight}}a.style.width=b.offsetWidth-this.conf.pr.ofs.w+"px";a.style.height=b.offsetHeight-this.conf.pr.ofs.h+"px";b=a=null};dhtmlXCellObject.prototype._showBorders=function(a){if(this.conf.borders){return}this.conf.borders=true;this.cell.childNodes[this.conf.idx.cont].className="dhx_cell_cont"+this.conf.css;this.conf.cells_cont=null;this._mtbUpdBorder();this.callEvent("_onBorderChange",[true]);if(a!==true){this._adjustCont(this._idd)}};dhtmlXCellObject.prototype._hideBorders=function(a){if(!this.conf.borders){return}this.conf.borders=false;this.cell.childNodes[this.conf.idx.cont].className="dhx_cell_cont"+this.conf.css+" dhx_cell_cont_no_borders";this.conf.cells_cont=null;this._mtbUpdBorder();this.callEvent("_onBorderChange",[false]);if(a!==true){this._adjustCont(this._idd)}};dhtmlXCellObject.prototype._getWidth=function(){return this.cell.offsetWidth};dhtmlXCellObject.prototype._getHeight=function(){return this.cell.offsetHeight};dhtmlXCellObject.prototype.showInnerScroll=function(){this.cell.childNodes[this.conf.idx.cont].style.overflow="auto"};dhtmlXCellObject.prototype._unload=function(){this.conf.unloading=true;this.callEvent("_onCellUnload",[]);this.progressOff();this.unloadView(this.conf.view);this.dataNodes=null;this.cell.parentNode.removeChild(this.cell);this.cell=null;window.dhx4._eventable(this,"clear");for(var b in this.views){this.unloadView(b)}this.conf=null;for(var b in this){this[b]=null}};dhtmlXCellObject.prototype.attachObject=function(d,c){if(window.dhx4.s2b(c)&&!(typeof(window.dhtmlXWindowsCell)!="undefined"&&(this instanceof window.dhtmlXWindowsCell))){c=false}if(typeof(d)=="string"){d=document.getElementById(d)}if(d.parentNode==this.cell.childNodes[this.conf.idx.cont]){d=null;return}if(c){d.style.display="";var a=d.offsetWidth;var b=d.offsetHeight}this._attachObject(d);this.dataType="obj";d.style.display="";d=null;if(c){this._adjustByCont(a,b)}};dhtmlXCellObject.prototype.appendObject=function(a){if(typeof(a)=="string"){a=document.getElementById(a)}if(a.parentNode==this.cell.childNodes[this.conf.idx.cont]){a=null;return}if(!this.conf.append_mode){this.cell.childNodes[this.conf.idx.cont].style.overflow="auto";this.conf.append_mode=true}this._attachObject(a,null,null,true);this.dataType="obj";a.style.display="";a=null};dhtmlXCellObject.prototype.detachObject=function(b,a){this._detachObject(null,b,a)};dhtmlXCellObject.prototype.getAttachedStatusBar=function(){return this.dataNodes.sb};dhtmlXCellObject.prototype.getAttachedObject=function(){return this.dataObj};dhtmlXCellObject.prototype.attachURL=function(b,j,c){if(c==true){c={}}var d=(typeof(c)!="undefined"&&c!=false&&c!=null);if(!this.conf.url_data){this.conf.url_data={}}this.conf.url_data.url=b;this.conf.url_data.ajax=(j==true);this.conf.url_data.post_data=(c==true?{}:(c||null));if(j==true){var i=this;if(d){var e="";for(var h in c){e+="&"+encodeURIComponent(h)+"="+encodeURIComponent(c[h])}dhx4.ajax.post(b,e,function(a){i.attachHTMLString("<div style='position:relative;width:100%;height:100%;overflow:auto;'>"+a.xmlDoc.responseText+"</div>");if(typeof(i._doOnFrameContentLoaded)=="function"){i._doOnFrameContentLoaded()}i.dataType="url-ajax";i=a=null})}else{dhx4.ajax.get(b,function(a){i.attachHTMLString("<div style='position:relative;width:100%;height:100%;overflow:auto;'>"+a.xmlDoc.responseText+"</div>");if(typeof(i._doOnFrameContentLoaded)=="function"){i._doOnFrameContentLoaded()}i.dataType="url-ajax";i=a=null})}}else{if(this.dataType=="url"){var f=this.getFrame()}else{var f=document.createElement("IFRAME");f.frameBorder=0;f.border=0;f.style.width="100%";f.style.height="100%";f.style.position="relative";this._attachObject(f);this.dataType="url";this._attachURLEvents()}if(d){var g=(typeof(this.conf.url_data.post_ifr)=="undefined");this.conf.url_data.post_ifr=true;if(g){this._attachURLEvents()}f.src="about:blank"}else{f.src=b+(window.dhx4.ajax.cache!=true?(b.indexOf("?")>=0?"&":"?")+"dhxr"+new Date().getTime():"")}f=null}f=null};dhtmlXCellObject.prototype.reloadURL=function(){if(!(this.dataType=="url"||this.dataType=="url-ajax")){return}if(this.conf.url_data==null){return}this.attachURL(this.conf.url_data.url,this.conf.url_data.ajax,this.conf.url_data.post_data)};dhtmlXCellObject.prototype.attachHTMLString=function(str){this._attachObject(null,null,str);var z=str.match(/<script[^>]*>[^\f]*?<\/script>/g)||[];for(var i=0;i<z.length;i++){var s=z[i].replace(/<([\/]{0,1})script[^>]*>/gi,"");if(s){if(window.execScript){window.execScript(s)}else{window.eval(s)}}}};dhtmlXCellObject.prototype.attachScheduler=function(a,g,b,d){d=d||window.scheduler;var e=false;if(b){var f=document.getElementById(b);if(f){e=true}}if(!e){var c=b||'<div class="dhx_cal_tab" name="day_tab" style="right:204px;"></div><div class="dhx_cal_tab" name="week_tab" style="right:140px;"></div><div class="dhx_cal_tab" name="month_tab" style="right:76px;"></div>';var f=document.createElement("DIV");f.id="dhxSchedObj_"+new Date().getTime();f.style.width="100%";f.style.height="100%";f.style.position="relative";f.style.overflow="hidden";f.className="dhx_cal_container";f.innerHTML='<div class="dhx_cal_navline"><div class="dhx_cal_prev_button">&nbsp;</div><div class="dhx_cal_next_button">&nbsp;</div><div class="dhx_cal_today_button"></div><div class="dhx_cal_date"></div>'+c+'</div><div class="dhx_cal_header"></div><div class="dhx_cal_data"></div>'}this._attachObject(f);this.dataType="scheduler";this.dataObj=d;this.dataObj.setSizes=function(){this.update_view()};d.init(f.id,a,g);f=null;this.callEvent("_onContentAttach",[]);return this.dataObj};dhtmlXCellObject.prototype.attachMap=function(a){var b=document.createElement("DIV");b.id="GMapsObj_"+this._genStr(12);b.style.width="100%";b.style.height="100%";b.style.position="relative";b.style.overflow="hidden";this._attachObject(b);if(!a){a={center:new google.maps.LatLng(40.719837,-73.992348),zoom:11,mapTypeId:google.maps.MapTypeId.ROADMAP}}this.dataType="maps";this.dataObj=new google.maps.Map(b,a);this.dataObj.setSizes=function(){google.maps.event.trigger(this,"resize")};b=null;this.callEvent("_onContentAttach",[]);return this.dataObj};dhtmlXCellObject.prototype._createNode_sb=function(g,d,f,a,e){if(typeof(e)!="undefined"){g=e}else{var b=d||{};var i=(typeof(b.text)=="string"&&b.text.length>0?b.text:"&nbsp;");var c=(typeof(b.height)=="number"?b.height:false);var g=document.createElement("DIV");g.className="dhx_cell_statusbar_def";g.innerHTML="<div class='"+(b.paging==true?"dhx_cell_statusbar_paging":"dhx_cell_statusbar_text")+"'>"+i+"</div>";if(c!=false){g.firstChild.style.height=g.firstChild.style.lineHeight=c+"px"}}if(this.conf.idx.pr1!=null){this.cell.insertBefore(g,this.cell.childNodes[this.conf.idx.pr1])}else{this.cell.appendChild(g)}this.conf.ofs_nodes.b.sb=true;this._updateIdx();this._adjustCont(this._idd);return g};dhtmlXCellObject.prototype.attachStatusBar=function(a){if(this.dataNodes.sb){return}if(a!=null&&window.dhx4.s2b(a.paging)==true){a.height=null}if(this.conf.skin=="dhx_skyblue"&&typeof(window.dhtmlXWindowsCell)!="undefined"&&(this instanceof dhtmlXWindowsCell)){this.cell.childNodes[this.conf.idx.cont].className+=" dhx_cell_statusbar_attached"}this.dataNodes.sb=this._attachObject("sb",a);this.dataNodes.sb.setText=function(b){this.childNodes[0].innerHTML=b};this.dataNodes.sb.getText=function(){return this.childNodes[0].innerHTML};this.dataNodes.sb.onselectstart=function(b){return false};return this.dataNodes.sb};dhtmlXCellObject.prototype.detachStatusBar=function(){if(!this.dataNodes.sb){return}if(this.conf.skin=="dhx_skyblue"&&typeof(window.dhtmlXWindowsCell)!="undefined"&&(this instanceof dhtmlXWindowsCell)){this.cell.childNodes[this.conf.idx.cont].className=this.cell.childNodes[this.conf.idx.cont].className.replace(/\s{0,}dhx_cell_statusbar_attached/,"")}this.dataNodes.sb.setText=this.dataNodes.sb.getText=this.dataNodes.sb.onselectstart=null;this.dataNodes.sb=null;delete this.dataNodes.sb;this._detachObject("sb")};dhtmlXCellObject.prototype.showStatusBar=function(){this._mtbShowHide("sb","")};dhtmlXCellObject.prototype.hideStatusBar=function(){this._mtbShowHide("sb","none")};dhtmlXCellObject.prototype._mtbShowHide=function(b,a){if(!this.dataNodes[b]){return}this.cell.childNodes[this.conf.idx[b]].style.display=a;this._adjustCont()};dhtmlXCellObject.prototype.getFrame=dhtmlXCellObject.prototype._getFrame=function(){if(this.dataType!="url"){return null}return this.cell.childNodes[this.conf.idx.cont].firstChild};dhtmlXCellObject.prototype._genStr=function(){if(!this._genStrId){this._genStrId=new Date().getTime()}return this._genStrId++};dhtmlXCellObject.prototype._attachURLEvents=function(){if(this.dataType!="url"){return}var c=this;var b=this._idd;var a=this.cell.childNodes[this.conf.idx.cont].firstChild;if(typeof(this._doOnFrameMouseDown)!="function"){this._doOnFrameMouseDown=function(d){c.callEvent("_onContentMouseDown",[b,d||event])}}if(typeof(window.addEventListener)=="function"){a.onload=function(){try{if(typeof(c._doOnFrameMouseDown)=="function"){this.contentWindow.document.body.addEventListener("mousedown",c._doOnFrameMouseDown,false)}}catch(d){}try{if(typeof(c._doOnFrameContentLoaded)=="function"){c._doOnFrameContentLoaded()}}catch(d){}}}else{a.onreadystatechange=function(d){if(this.readyState=="complete"){try{if(typeof(c._doOnFrameMouseDown)=="function"){this.contentWindow.document.body.attachEvent("onmousedown",c._doOnFrameMouseDown)}}catch(f){}try{if(typeof(c._doOnFrameContentLoaded)=="function"){c._doOnFrameContentLoaded()}}catch(f){}}}}};dhtmlXCellObject.prototype._doOnFrameContentLoaded=function(){if(this.conf.url_data.post_ifr==true){var h=this.getFrame().contentWindow.document;var g=h.createElement("FORM");g.method="POST";g.action=this.conf.url_data.url;h.body.appendChild(g);var c={};if(window.dhx4.ajax.cache!=true){c["dhxr"+new Date().getTime()]="1"}for(var b in this.conf.url_data.post_data){c[b]=this.conf.url_data.post_data[b]}for(var b in c){var e=h.createElement("INPUT");e.type="hidden";e.name=b;e.value=c[b];g.appendChild(e);e=null}this.conf.url_data.post_ifr=false;g.submit()}else{this.callEvent("_onContentLoaded",[this._idd])}};dhtmlXCellObject.prototype._detachURLEvents=function(a){if(a==null){if(this.dataType!="url"){return}a=this.cell.childNodes[this.conf.idx.cont].firstChild}if(typeof(window.addEventListener)=="function"){a.onload=null;try{a.contentWindow.document.body.removeEventListener("mousedown",this._doOnFrameMouseDown,false)}catch(b){}}else{a.onreadystatechange=null;try{a.contentWindow.document.body.detachEvent("onmousedown",this._doOnFrameMouseDown)}catch(b){}}a=null};dhtmlXCellObject.prototype._attachObject=function(e,b,d,a,c){if(typeof(e)=="string"&&{menu:1,toolbar:1,ribbon:1,sb:1}[e]==1){return this["_createNode_"+e].apply(this,arguments)}if(a!=true){this._detachObject(null,true,null)}if(typeof(d)=="string"){this.cell.childNodes[this.conf.idx.cont].innerHTML=d}else{this.cell.childNodes[this.conf.idx.cont].appendChild(e)}e=null};dhtmlXCellObject.prototype._detachObject=function(e,b,a){this.callEvent("_onBeforeContentDetach",[]);if(e=="menu"||e=="toolbar"||e=="ribbon"||e=="sb"){var d=this.cell.childNodes[this.conf.idx[e]];d.parentNode.removeChild(d);d=null;this.conf.ofs_nodes[e=="sb"?"b":"t"][e]=false;this._updateIdx();if(!this.conf.unloading){this._adjustCont(this._idd)}return}if(b==true){a=false}else{if(typeof(a)=="undefined"){a=document.body}else{if(typeof(a)=="string"){a=document.getElementById(a)}}}if(a===false){if(this.dataType=="url"){this._detachURLEvents()}else{if(this.dataObj!=null){if(typeof(this.dataObj.unload)=="function"){this.dataObj.unload()}else{if(typeof(this.dataObj.destructor)=="function"){this.dataObj.destructor()}}}}}var d=this.cell.childNodes[this.conf.idx.cont];while(d.childNodes.length>0){if(a===false){d.removeChild(d.lastChild)}else{d.firstChild.style.display="none";a.appendChild(d.firstChild)}}if(this.conf.append_mode){d.style.overflow="";this.conf.append_mode=false}var c=(this.dataType=="tabbar");this.dataObj=null;this.dataType=null;a=d=null;if(this.conf.unloading!=true&&c){this.showHeader(true);this._showBorders()}};dhtmlXCellObject.prototype._attachFromCell=function(b){this.detachObject(true);var d="layout";if(typeof(window.dhtmlXWindowsCell)!="undefined"&&this instanceof window.dhtmlXWindowsCell){d="window"}if(typeof(window.dhtmlXWindowsCell)!="undefined"&&b instanceof window.dhtmlXWindowsCell&&b.wins.w[b._idd].conf.parked){b.wins._winCellSetOpacity(b._idd,"open",false)}if(typeof(window.dhtmlXAccordionCell)!="undefined"&&b instanceof window.dhtmlXAccordionCell&&b.conf.opened==false){b._cellSetOpacity("open",false)}for(var c in b.dataNodes){this._attachObject(c,null,null,null,b.cell.childNodes[b.conf.idx[c]]);this.dataNodes[c]=b.dataNodes[c];b.dataNodes[c]=null;b.conf.ofs_nodes[c=="sb"?"b":"t"][c]=false;b._updateIdx()}this._mtbUpdBorder();if(b.dataType!=null&&b.dataObj!=null){this.dataType=b.dataType;this.dataObj=b.dataObj;while(b.cell.childNodes[b.conf.idx.cont].childNodes.length>0){this.cell.childNodes[this.conf.idx.cont].appendChild(b.cell.childNodes[b.conf.idx.cont].firstChild)}b.dataType=null;b.dataObj=null;if(this.dataType=="grid"){if(d=="window"&&this.conf.skin=="dhx_skyblue"){this.dataObj.entBox.style.border="1px solid #a4bed4";this.dataObj._sizeFix=0}else{this.dataObj.entBox.style.border="0px solid white";this.dataObj._sizeFix=2}}}else{while(b.cell.childNodes[b.conf.idx.cont].childNodes.length>0){this.cell.childNodes[this.conf.idx.cont].appendChild(b.cell.childNodes[b.conf.idx.cont].firstChild)}}this.conf.view=b.conf.view;b.conf.view="def";for(var c in b.views){this.views[c]=b.views[c];b.views[c]=null;delete b.views[c]}b._updateIdx();b._adjustCont();this._updateIdx();this._adjustCont();if(b.conf.progress==true){b.progressOff();this.progressOn()}else{this.progressOff()}if(d=="window"&&this.wins.w[this._idd].conf.parked){this.wins._winCellSetOpacity(this._idd,"close",false)}};function dhtmlXRibbon(d){var c=this,b,a;this.conf={type:"ribbon",icons_path:(d&&d.icons_path)?d.icons_path:"",arrows_mode:(d&&d.arrows_mode)?d.arrows_mode:null,skin:"dhx_skyblue"};this._eventHandlers={};this._base=null;this._items={};this._tabbar=null;this.childIds=[];if(typeof(d)=="string"){a=d}else{if(d&&d.tagName){a=d}else{if(d&&d.parent){if(d.parent.tagName||typeof(d.parent)=="string"){a=d.parent}}}}this._doOnHighlight0=function(i){i=i||event;var h=i.target||i.srcElement;var f=c._findItemByNode(h);var g=c._items[f._dhx_ribbonId];if(g.conf.disable){return}if(c.items[g.type]&&typeof(c.items[g.type].mouseover)=="function"){if(c.items[g.type].mouseover(g,c,i)!=true){return false}}if(!/dhxrb_highlight0/.test(f.className)){f.className+=" dhxrb_highlight0"}};this._doOffHighlight0=function(i){i=i||event;var h=i.target||i.srcElement;var f=c._findItemByNode(h);var g=c._items[f._dhx_ribbonId];if(g.conf.disable){return}if(c.items[g.type]&&typeof(c.items[g.type].mouseout)=="function"){if(c.items[g.type].mouseout(g,c,i)!=true){return false}}if(/dhxrb_highlight1/.test(f.className)){f.className=f.className.replace(/\s?dhxrb_highlight1/,"")}if(/dhxrb_highlight0/.test(f.className)){f.className=f.className.replace(/\s?dhxrb_highlight0/,"")}};this._doOnHighlight1=function(i){i=i||event;var h=i.target||i.srcElement;var f=c._findItemByNode(h);var g=c._items[f._dhx_ribbonId];if(g.conf.disable){return}c.callEvent("_showPopup",[g.id]);if(c.items[g.type]&&typeof(c.items[g.type].mousedown)=="function"){if(c.items[g.type].mousedown(g,c,i)!=true){return false}}if(!/dhxrb_highlight1/.test(f.className)){f.className+=" dhxrb_highlight1"}};this._doOffHighlight1=function(i){i=i||event;var h=i.target||i.srcElement;var f=c._findItemByNode(h);var g=c._items[f._dhx_ribbonId];if(g.conf.disable){return}if(c.items[g.type]&&typeof(c.items[g.type].mouseup)=="function"){if(c.items[g.type].mouseup(g,c,i)!=true){return false}}if(/dhxrb_highlight1/.test(f.className)){f.className=f.className.replace(/\s?dhxrb_highlight1/,"")}};this._doOnClick=function(i){i=i||event;var h=i.target||i.srcElement;var f=c._findItemByNode(h);var g=c._items[f._dhx_ribbonId];if(g.conf.disable){return}if(c.items[g.type]&&typeof(c.items[g.type].click)=="function"){c.items[g.type].click(g,c,i)}};this._doOnFocus=function(i){i=i||event;var h=i.target||i.srcElement;var f=c._findItemByNode(h);var g=c._items[f._dhx_ribbonId];if(g.conf.disable){return}c.callEvent("_showPopup",[g.id]);if(c.items[g.type]&&typeof(c.items[g.type].focus)=="function"){c.items[g.type].focus(g,c,i)}};this._doOnBlur=function(i){i=i||event;var h=i.target||i.srcElement;var f=c._findItemByNode(h);var g=c._items[f._dhx_ribbonId];if(g.conf.disable){return}if(c.items[g.type]&&typeof(c.items[g.type].blur)=="function"){c.items[g.type].blur(g,c,i)}};this._doOnChange=function(i){i=i||event;var h=i.target||i.srcElement;var f=c._findItemByNode(h);var g=c._items[f._dhx_ribbonId];if(g.conf.disable){return}if(c.items[g.type]&&typeof(c.items[g.type].change)=="function"){c.items[g.type].change(g,c,i)}};this._doOnKeydown=function(i){i=i||event;var h=i.target||i.srcElement;var f=c._findItemByNode(h);var g=c._items[f._dhx_ribbonId];if(g.conf.disable){return}if(c.items[g.type]&&typeof(c.items[g.type].keydown)=="function"){c.items[g.type].keydown(g,c,i)}};this._tabCustomApi={enable:function(h,g){var f=null,e=null;g=g||false;if(g!=true){f=c._items[this._idd];for(e in f.childIds){e=parseInt(e);c.enable(f.childIds[e])}}return c._tabOriginalApi.enable.apply(this,[h])},disable:function(h,g){var f=null,e=null;if(g!=false){f=c._items[this._idd];for(e in f.childIds){e=parseInt(e);c.disable(f.childIds[e])}}return c._tabOriginalApi.disable.apply(this,[h])},close:function(g){var f=c._items[this._idd],e;c._removeTab(f);c._tabOriginalApi.close.apply(this,[g]);for(e in c._tabOriginalApi){this[e]=null}}};this._attachEventTabbar=function(){this._tabbar.attachEvent("onSelect",function(){return c.callEvent("onSelect",arguments)});this._tabbar.attachEvent("onTabClick",function(){return c.callEvent("onTabClick",arguments)});this._tabbar.attachEvent("onTabClose",function(){return c.callEvent("onTabClose",arguments)})};if(typeof(a)=="string"){this._base=document.getElementById(a)}else{if(a&&a.tagName){this._base=a}else{this._base=document.createElement("div");this._base._dhx_remove=true;if(document.body.firstChild){document.body.insertBefore(this._base,document.body.firstChild)}else{document.body.appendChild(this._base)}}}b=dhx4.skin||(typeof(dhtmlx)!="undefined"?dhtmlx.skin:null)||dhx4.skinDetect("dhtmlxribbon")||"dhx_skyblue";if(typeof(d)=="object"&&d.skin){b=d.skin}this.setSkin(b);dhx4._eventable(this);dhx4._enableDataLoading(this,"_renderData","_xmlToJson","ribbon",{struct:true});this.attachEvent("_onHeightChanged",function(){this.conf.inited=true});this._base.className+=" dhxrb_without_tabbar";this._base.innerHTML="<div class='dhxrb_background_area'></div>";if(d!=null){if(d.json){this.loadStruct(d.json,d.onload)}else{if(d.xml){this.loadStruct(d.xml,d.onload)}else{this._renderData(d)}}}this.unload=function(){var f=null,e=[];for(f in this.childIds){f=parseInt(f);e.push(this.childIds[f])}dhx4._enableDataLoading(this,null,null,null,"clear");dhx4._eventable(this,"clear");for(f in e){f=parseInt(f);if(this._items[e[f]].type=="tab"){this.tabs(e[f]).close(false)}else{this.removeItem(e[f])}}if(this._tabbar){this._tabbar.unload();this._tabbar=null}this._base.innerHTML="";if(this._base._dhx_remove){this._base.parentNode.removeChild(this._base)}else{this._base.className=this._base.className.replace(/\s?(dhtmlx|dhxrb)(\S*)/ig,"")}for(f in this){this[f]=null}c=null}}dhtmlXRibbon.prototype.setSizes=function(){if(this._tabbar!=null&&typeof(this.setSizes)=="function"){this._tabbar.setSizes()}};dhtmlXRibbon.prototype._renderData=function(b){var a=this._base.firstChild;if(b!=null){this.conf.icons_path=b.icons_path||this.conf.icons_path;if(b.tabs instanceof Array){this._base.className=this._base.className.replace(/\s?dhxrb_without_tabbar/i,"");a.className="dhxrb_with_tabbar";this._tabbar=new dhtmlXTabBar(a);this._attachEventTabbar();this._tabbar.setSkin(this.conf.skin);if(this.conf.arrows_mode!=null){this._tabbar.setArrowsMode(this.conf.arrows_mode)}this.childIds=this._appendTabs(b.tabs)}else{if(b.items instanceof Array){if(!/\s?dhxrb_without_tabbar/i.test(this._base.className)){this._base.className+=" dhxrb_without_tabbar"}if(/\s?dhxrb_background_area/i.test(a.className)){a.className="dhxrb_background_area"}a.innerHTML="<div class='dhxrb_g_area'></div>";this.childIds=this._appendBlocks(b.items,a.firstChild)}}this.callEvent("_onHeightChanged",[])}};dhtmlXRibbon.prototype._xmlToJson=function(b){var a=b.lastChild||null,d={},c=[];if(a&&a.tagName=="ribbon"){c=this._convertXmlNodeListIntoObject(a.childNodes)}if(c[0]&&c[0].type&&c[0].type.toLowerCase()=="block"){d.items=c}else{d.tabs=c}return d};dhtmlXRibbon.prototype._convertXmlNodeListIntoObject=function(b){var c,a,e=[],d;a=b.length;for(c=0;c<a;c++){d=this._covertXmlNodeToObject(b[c]);if(d){e.push(d)}}return e};dhtmlXRibbon.prototype._covertXmlNodeToObject=function(d){if(!d||!d.tagName||!(d.tagName.toLowerCase()=="item"||d.tagName.toLowerCase()=="tab")){return null}var c,a,b=d.attributes,e={};a=b.length;for(c=0;c<a;c++){switch(b[c].name){case"isbig":e.isbig=dhx4.s2b(b[c].value);break;case"state":e.state=dhx4.s2b(b[c].value);break;default:e[b[c].name]=b[c].value}}if(d.childNodes.length){if(d.getAttribute("type")=="buttonCombo"||d.getAttribute("type")=="buttonSelect"){e.data=d}else{if(d.tagName.toLowerCase()=="tab"){e.items=this._convertXmlNodeListIntoObject(d.childNodes)}else{e.list=this._convertXmlNodeListIntoObject(d.childNodes)}}}return e};dhtmlXRibbon.prototype._appendTabs=function(e){var b,a,c,d=[];a=e.length;for(b=0;b<a;b++){c=this._addTab(e[b]);if(e[b].items instanceof Array){c.childIds=this._appendBlocks(e[b].items,c.base,c)}d.push(c.id)}return d};dhtmlXRibbon.prototype._addTab=function(c){var a,d,b={conf:{active:false,text:"",width:null,position:null,disable:false},base:document.createElement("div"),type:"tab",childIds:[]};for(a in c){if(a=="items"){continue}b.conf[a]=c[a]}if(!c.id){b.id=dhx4.newId()}else{b.id=c.id}while(this._items[b.id]){b.id=dhx4.newId()}this._tabbar.addTab(b.id,b.conf.text,b.conf.width,b.conf.position,b.conf.active);b.base.className="dhxrb_g_area";b.base._dhx_ribbonId=b.id;this.tabs(b.id).attachObject(b.base);this._changeApiForTab(this.tabs(b.id));this._items[b.id]=b;return b};dhtmlXRibbon.prototype._changeApiForTab=function(b){var a;for(a in this._tabOriginalApi){this._tabOriginalApi[a]=this._tabOriginalApi[a]||b[a];b[a]=this._tabCustomApi[a]}};dhtmlXRibbon.prototype._tabOriginalApi={enable:null,disable:null,close:null};dhtmlXRibbon.prototype._appendBlocks=function(a,k,c){var f,d,g,e,h,b,j=[];c=c||null;d=a.length;for(f=0;f<d;f++){if(typeof(a[f])=="object"&&a[f].type=="block"){g=this._addBlock(a[f],k);if(a[f].list&&(a[f].list instanceof Array)){e=a[f].list;h=e.length;for(b=0;b<h;b++){this._addItem(g.id,null,null,e[b])}}if(c!=null){g.parentId=c.id}if(g.conf.disable){this.disable(g.id)}j.push(g.id)}}return j};dhtmlXRibbon.prototype._addBlock=function(e,d){var c,a,f,b;f={conf:{text:"",text_pos:"bottom",type:"block",mode:"cols",disable:false},type:"block",childIds:[],base:document.createElement("div"),contForItems:document.createElement("div"),contForText:document.createElement("div")};for(b in e){if(b=="list"||b=="type"||b=="id"){continue}f.conf[b]=e[b]}if(!e.id){f.id=dhx4.newId()}else{f.id=e.id}while(this._items[f.id]){f.id=dhx4.newId()}f.base.className="dhxrb_block_base";d.appendChild(f.base);f.contForItems.className="dhxrb_block_items";f.contForText.className="dhxrb_block_label";f.base.appendChild(f.contForItems);if(f.conf.text){f.contForText.innerHTML=f.conf.text;if(f.conf.text_pos=="top"){f.base.insertBefore(f.contForText,f.contForItems)}else{f.base.appendChild(f.contForText)}}f.base._dhx_ribbonId=f.id;this._items[f.id]=f;return f};dhtmlXRibbon.prototype._addItem=function(c,b,i,g){var e=this._items[c],a,f,k=null,h=this,d;if(g.type!="newLevel"&&!this.items[g.type]){return null}if(g.type=="newLevel"){this._addNewLevel(e)}else{if(e.type=="group"){a=document.createElement("div");a.className="dhxrb_in_group";e.base.appendChild(a)}else{if(g.isbig){a=document.createElement("div");a.className="dhxrb_big_button";e.contForItems.appendChild(a)}else{f=this._getContainerForSmallItem(e);a=document.createElement("div");a.className=(e.conf.mode=="rows")?"dhxrb_in_row":"dhxrb_3rows_button";f.appendChild(a)}}}if(a){this._attachEventForItem(a);d={icons_path:g.icons_path||this.conf.icons_path,skin:this.conf.skin};for(var j in g){d[j]=g[j]}if(!d.id){d.id=dhx4.newId()}while(this._items[d.id]){d.id=dhx4.newId()}k=(this.items[d.type]&&this.items[d.type].render)?this.items[d.type].render(a,d):null}if(k!=null){this._items[k.id]=k;k.parentId=e.id;e.childIds.push(k.id);a._dhx_ribbonId=k.id;if(d.onclick&&(typeof(d.onclick)=="function")){this._eventHandlers[k.id]=this._eventHandlers[k.id]||{};this._eventHandlers[k.id]["onclick"]=d.onclick}k.callEvent=function(){h.callEvent.apply(h,arguments)};k._callHandler=function(){h._callHandler.apply(h,arguments)};if(this.items[d.type]&&typeof(this.items[d.type].callAfterInit)=="function"){this.items[d.type].callAfterInit.apply(this,[k])}}return k};dhtmlXRibbon.prototype._callHandler=function(b,a){if(this._eventHandlers[b]&&this._eventHandlers[b].onclick){this._eventHandlers[b].onclick.apply(this,a)}};dhtmlXRibbon.prototype.items={};dhtmlXRibbon.prototype.items.button={render:function(b,a){var c,d;d={base:b,id:a.id,type:a.type,conf:{text:"",text_pos:(a.isbig)?"bottom":"right",img:null,imgdis:null,isbig:false,disable:false,skin:a.skin}};for(c in a){if(c=="id"||c=="onclick"||c=="type"){continue}d.conf[c]=a[c]}b.innerHTML="<img class='dhxrb_image"+((d.conf.img)?"'":" dhxrb_invisible'")+" src='"+((d.conf.img)?d.conf.icons_path+d.conf.img:"")+"' /><div class='dhxrb_label_button'>"+d.conf.text+"</div>";if(typeof(this.afterRender)=="function"){this.afterRender(d)}if(d.conf.disable){this.disable(d)}return d},getText:function(a){return a.conf.text},setText:function(b,c){var a=b.base.childNodes[1];b.conf.text=c;a.innerHTML=c},setImage:function(b,a){b.conf.img=a;if(b.conf.disable==false){b.base.childNodes[0].src=b.conf.icons_path+b.conf.img}},setImageDis:function(b,a){b.conf.imgdis=a;if(b.conf.disable==true){b.base.childNodes[0].src=b.conf.icons_path+b.conf.imgdis}},mousedown:function(a,c,b){return true},click:function(a,c,b){if(b.button!=0){return false}c._callHandler(a.id,[a.id]);a.callEvent("onClick",[a.id]);return false},disable:function(b){var c=b.base.childNodes[0],a=b.base.childNodes[1];if(b.conf.imgdis){c.src=b.conf.icons_path+b.conf.imgdis;if(/\s?dhxrb_invisible/i.test(c.className)){c.className=c.className.replace(/\s?dhxrb_invisible/i,"")}}if(!/\s?dhxrb_disable_text_style/i.test(a.className)){a.className+=" dhxrb_disable_text_style"}return true},enable:function(b){var c=b.base.childNodes[0],a=b.base.childNodes[1];if(b.conf.img){c.src=b.conf.icons_path+b.conf.img}else{if(!/\s?dhxrb_invisible/i.test(c.className)){c.className+=" dhxrb_invisible"}}if(/\s?dhxrb_disable_text_style/i.test(a.className)){a.className=a.className.replace(/\s?dhxrb_disable_text_style/i,"")}return true}};dhtmlXRibbon.prototype.items.buttonTwoState={click:function(a,c,b){return false},afterRender:function(a){if(a.conf.state){this.setState(a,a.conf.state)}},mouseover:function(a){if(!/dhxrb_highlight0/.test(a.base.className)){a.base.className+=" dhxrb_highlight0"}return false},mouseout:function(a){if(/dhxrb_highlight0/.test(a.base.className)){a.base.className=a.base.className.replace(/\s?dhxrb_highlight0/,"")}return false},mousedown:function(a,c,b){c._callHandler(a.id,[a.id,!a.conf.state]);this.setState(a,!a.conf.state,true);return false},mouseup:function(a){return false},setState:function(a,b,c){c=c||false;b=dhx4.s2b(b);if(b){if(!/dhxrb_highlight1/.test(a.base.className)){a.base.className+=" dhxrb_highlight1"}}else{if(/dhxrb_highlight1/.test(a.base.className)){a.base.className=a.base.className.replace(/\s?dhxrb_highlight1/,"")}}a.conf.state=b;if(c){a.callEvent("onStateChange",[a.id,a.conf.state])}}};dhtmlXRibbon.prototype.items.buttonSegment={click:function(a,c,b){return false},mousedown:function(a,c,b){this.setState(a,c,true);return false},callAfterInit:function(a){if(a.conf.state||dhtmlXRibbon.prototype.items.buttonSegment._getSelectedNeighbor(a,this)==null){if(a.conf.state){a.conf.state=false}dhtmlXRibbon.prototype.items.buttonSegment.setState(a,this,false)}},afterRender:function(){},setState:function(a,e,d){d=d||false;var c=null,b=dhx4.s2b(a.conf.state);if(b==false){c=this._getSelectedNeighbor(a,e);if(c!=null){this._unSelect(c)}if(!/dhxrb_highlight1/.test(a.base.className)){a.base.className+=" dhxrb_highlight1"}a.conf.state=true;if(d){e._callHandler(a.id,[a.id,(c?c.id:null)]);e.callEvent("onStateChange",[a.id,(c?c.id:null)])}}},remove:function(c,g){var e=dhx4.s2b(c.conf.state),f=null,a=0,b=g._items[c.parentId],d;if(e){while(b.childIds[a]&&f==null){d=g._items[b.childIds[a]];if(d.type=="buttonSegment"&&d!=c){f=d}a++}if(f){this.setState(f,g)}}},_unSelect:function(a){var b=dhx4.s2b(a.conf.state);if(b){if(/dhxrb_highlight1/.test(a.base.className)){a.base.className=a.base.className.replace(/\s?dhxrb_highlight1/,"")}a.conf.state=false}},_getSelectedNeighbor:function(d,g){var c=g._items[d.parentId],b,a,f,e=null;a=c.childIds.length;for(b=0;b<a;b++){f=g._items[c.childIds[b]];if(f.type=="buttonSegment"&&f.conf.state){e=f;break}}return e}};dhtmlXRibbon.prototype.items.buttonSelect={itemCollection:[],_isAttachedEventInWindow:false,afterRender:function(b){var a=b.base.childNodes[1];a.innerHTML+="<span class='dhxrb_arrow'>&nbsp;</span>";b.menu=null;this.itemCollection.push(b);this._attachEventToWindow();a=null},setText:function(a,c){var b=a.base.childNodes[1].lastChild;a.conf.text=c;a.base.childNodes[1].innerHTML=c;a.base.childNodes[1].appendChild(b)},_attachEventToWindow:function(){if(this._isAttachedEventInWindow==false){if(typeof(window.addEventListener)=="function"){document.body.addEventListener("mousedown",this._hideAllMenus,false)}else{document.body.attachEvent("onmousedown",this._hideAllMenus)}this._isAttachedEventInWindow=true}},_detachEventFromWindow:function(){if(typeof(window.addEventListener)=="function"){document.body.removeEventListener("mousedown",this._hideAllMenus,false)}else{document.body.detachEvent("onmousedown",this._hideAllMenus)}this._isAttachedEventInWindow=false},_hideAllMenus:function(f){f=f||event;var c=f.target||f.srcElement;var a=true;while(c!=null&&a==true){if(c.className!=null&&/SubLevelArea_Polygon/i.test(c.className)){a=false}else{c=c.parentNode}}if(a==false){return}var b=dhtmlXRibbon.prototype.items.buttonSelect.itemCollection;for(var g in b){var d=b[g];if(d.menu instanceof dhtmlXMenuObject){if(d._skipHiding){d._skipHiding=false}else{dhtmlXRibbon.prototype.items.buttonSelect.hideMenu(d)}}}},mousedown:function(a,c,b){a._skipHiding=true;this.showMenu(a);return false},mouseup:function(a){return false},click:function(){},setState:function(){},showMenu:function(b){var a=dhx4.absLeft(b.base),c=dhx4.absTop(b.base)+b.base.offsetHeight;if(!(b.menu instanceof dhtmlXMenuObject)){b.menu=new dhtmlXMenuObject({parent:b.base,icons_path:b.conf.icons_path,context:true,items:b.conf.items,skin:b.conf.skin});if(b.conf.data){b.menu.loadStruct(b.conf.data);delete b.conf.data}b.menu.setAutoHideMode(false);b.menu.attachEvent("onHide",function(d){if(d==null){dhtmlXRibbon.prototype.items.buttonSelect._doOnHideMenu(b)}});b.menu.attachEvent("onShow",function(d){if(d==null){dhtmlXRibbon.prototype.items.buttonSelect._doOnShowMenu(b)}});b.menu.attachEvent("onClick",function(d){b.callEvent("onClick",[d])});b.base.oncontextmenu=function(){return false};dhtmlXRibbon.prototype.items.buttonSelect.showMenu(b)}else{b.menu.showContextMenu(a,c)}},hideMenu:function(a){if(a.menu instanceof dhtmlXMenuObject){a.menu.hideContextMenu()}},remove:function(b){var c,a;if(b.menu instanceof dhtmlXMenuObject){b.menu.unload();b.menu=null}b.base.oncontextmenu=null;c=dhtmlXRibbon.prototype._indexOf(dhtmlXRibbon.prototype.items.buttonSelect.itemCollection,b);if(c!=-1){dhtmlXRibbon.prototype.items.buttonSelect.itemCollection.splice(c,1)}if(dhtmlXRibbon.prototype.items.buttonSelect.itemCollection.length==0){this._detachEventFromWindow()}},setSkin:function(a,b){if(a.menu instanceof dhtmlXMenuObject){a.menu.setSkin(b)}},_doOnHideMenu:function(a){if(a._skipHiding){a._skipHiding=false}else{if(/dhxrb_highlight1/.test(a.base.className)){a.base.className=a.base.className.replace(/\s?dhxrb_highlight1/,"")}}},_doOnShowMenu:function(a){if(!/dhxrb_highlight1/.test(a.base.className)){a.base.className+=" dhxrb_highlight1"}}};dhtmlXRibbon.prototype.items.group={render:function(b,a){var c,d;d={base:b,id:a.id,type:a.type,conf:{disable:false,skin:a.skin},childIds:[]};b.className="dhxrb_group";for(c in a){if(c=="id"||c=="onclick"||c=="type"){continue}d.conf[c]=a[c]}return d},callAfterInit:function(e){this._detachEventFromItem(e.base);var d,a,f=e.conf.list,g,c,b;a=(f)?f.length:0;for(d=0;d<a;d++){g=this._addItem(e.id,null,null,f[d]);if(g==null){continue}c=g.base.childNodes[1];if(c&&!c.innerHTML&&!/\s?dhxrb_label_hide/i.test(c.className)){c.className+=" dhxrb_label_hide"}}dhtmlXRibbon.prototype.items.group.normalize(e);if(e.conf.disable){this.disable(e.id)}f=undefined},normalize:function(h){var a=h.base.children;var c=a.length,b=false,j=0;var e,g;for(var f=0;f<c;f++){if(!/dhxrb_separator_group/i.test(a[f].className)){if(/dhxrb_item_hide/i.test(a[f].className)){j++;continue}}if((Math.ceil((f-j)/2)-Math.floor((f-j)/2))==0){if(/dhxrb_separator_group/i.test(a[f].className)){a[f].parentNode.removeChild(a[f]);b=true;break}}else{if(!/dhxrb_separator_group/i.test(a[f].className)){e=document.createElement("div");e.className="dhxrb_separator_groupp";h.base.insertBefore(e,a[f]);b=true;break}}}if(b){this.normalize(h)}else{g=h.base.lastChild;if(g&&/dhxrb_separator_group/i.test(g.className)){g.parentNode.removeChild(g)}}},hideChild:function(b,d){var a=dhtmlXRibbon.prototype._indexOf(b.base.children,d.base);if(a==0){a++}else{if(a!=-1){a--}else{return}}var c=b.base.children[a];if(c&&/dhxrb_separator_group/i.test(c.className)){c.parentNode.removeChild(c)}},showChild:function(a){this.normalize(a)}};dhtmlXRibbon.prototype.items.input={render:function(b,a){var c,d;d={base:b,id:a.id,type:a.type,conf:{text:"",text_pos:(a.isbig)?"bottom":"right",img:null,imgdis:null,isbig:false,disable:false,skin:a.skin,value:""}};for(c in a){if(c=="id"||c=="onclick"||c=="type"){continue}d.conf[c]=a[c]}b.innerHTML="<input type='text' class='dhxrb_input'><div class='dhxrb_label_button'>"+d.conf.text+"</div>";if(typeof(this.afterRender)=="function"){this.afterRender(d)}if(d.conf.disable){this.disable(d)}if(d.conf.width){this.setWidth(d,d.conf.width)}if(d.conf.value){this.setValue(d,d.conf.value)}return d},callAfterInit:function(b){var a=b.base.childNodes[0];this._detachEventFromItem(b.base);this._attachEventsToInput(a)},setText:dhtmlXRibbon.prototype.items.button.setText,getText:dhtmlXRibbon.prototype.items.button.getText,change:function(b){var a=b.base.childNodes[0];b.conf.value=a.value},keydown:function(b,d,c){if(c.keyCode==13){var a=b.base.childNodes[0];b.conf.value=a.value;d.callEvent("onEnter",[b.id,b.conf.value])}},remove:function(b,c){var a=b.base.childNodes[0];c._detachEventsFromInput(a)},getValue:function(b){var a=b.base.childNodes[0],c;c=a.value;a=undefined;return c},setValue:function(b,c){var a=b.base.childNodes[0],c;a.value=c;b.conf.value=c},setWidth:function(b,c){var a=b.base.childNodes[0];a.style.width=parseInt(c)+"px"},disable:function(c){var b=c.base.childNodes[0],a=c.base.childNodes[1];b.disabled=true;if(!/\s?dhxrb_disable_text_style/i.test(a.className)){a.className+=" dhxrb_disable_text_style"}return true},enable:function(c){var b=c.base.childNodes[0],a=c.base.childNodes[1];b.disabled=false;if(/\s?dhxrb_disable_text_style/i.test(a.className)){a.className=a.className.replace(/\s?dhxrb_disable_text_style/i,"")}return true},getInput:function(a){return a.base.childNodes[0]}};dhtmlXRibbon.prototype.getInput=function(b){var a=this._items[b];if(a==null||a.type!="input"){return null}return this.items[a.type].getInput(a)};dhtmlXRibbon.prototype.items.checkbox={render:function(b,a){var c,d;d={base:b,id:a.id,type:a.type,conf:{text:"",text_pos:(a.isbig)?"bottom":"right",disable:false,checked:false}};for(c in a){if(c=="id"||c=="onclick"||c=="type"){continue}d.conf[c]=a[c]}b.innerHTML="<div class='dhxrb_checkbox'></div><div class='dhxrb_label_checkbox'>"+d.conf.text+"</div>";if(typeof(this.afterRender)=="function"){this.afterRender(d)}if(d.conf.checked){this.check(d)}return d},callAfterInit:function(a){if(a.conf.disable){this.disable(a.id)}},setText:dhtmlXRibbon.prototype.items.button.setText,getText:dhtmlXRibbon.prototype.items.button.getText,mousedown:function(a){return false},mouseup:function(a){return false},click:function(a,c,b){if(b.button!=0){return false}if(a.type=="checkbox"){if(a.conf.checked){this.uncheck(a,true)}else{this.check(a,true)}}},check:function(a,b){b=b||false;if(a.type!="checkbox"){return}a.conf.checked=true;if(!/\s?dhxrb_checked/i.test(a.base.className)){a.base.className+=" dhxrb_checked"}if(b){a.callEvent("onCheck",[a.id,a.conf.checked])}},uncheck:function(a,b){b=b||false;if(a.type!="checkbox"){return}a.conf.checked=false;if(/\s?dhxrb_checked/i.test(a.base.className)){a.base.className=a.base.className.replace(/\s?dhxrb_checked/i,"")}if(b){a.callEvent("onCheck",[a.id,a.conf.checked])}},disable:function(a){return true},enable:function(a){return true}};dhtmlXRibbon.prototype.items.text={render:function(a,d){var c={base:a,id:d.id,type:d.type,conf:{text:""}};for(var b in d){if(b=="id"||b=="type"){continue}c.conf[b]=d[b]}a.innerHTML="<div class='dhxrb_item_text'>"+c.conf.text+"</div>";if(typeof(this.afterRender)=="function"){this.afterRender(c)}return c},callAfterInit:function(a){this._detachEventFromItem(a.base)},getText:function(a){return a.conf.text},setText:function(a,b){a.conf.text=b;a.base.innerHTML=b}};dhtmlXRibbon.prototype.items.buttonCombo={render:function(a,b){var c,d,e={};d={base:a,id:b.id,type:b.type,conf:{text:"",text_pos:"right",width:140,skin:b.skin,callEvent:true}};for(c in b){if(c=="id"||c=="onclick"||c=="type"){continue}d.conf[c]=b[c]}for(c in d.conf){if(c=="text"||c=="text_pos"||c=="disable"||c=="data"){continue}e[c]=d.conf[c]}d.base.className+=" dhxrb_buttoncombo_cont";d.base.innerHTML="<div class='dhxrb_buttoncombo'></div><div class='dhxrb_label_button'>"+d.conf.text+"</div>";e.parent=d.base.firstChild;d.combo=new dhtmlXCombo(e);d.combo.setSkin(e.skin);d.combo.attachEvent("onChange",function(f,g){d._callHandler(d.id,[f,g]);if(d.conf.callEvent==true){d.callEvent("onSelectOption",[d.id,f,g])}d.conf.callEvent=true});if(d.conf.data){d.combo.load(d.conf.data);delete d.conf.data}if(typeof(this.afterRender)=="function"){this.afterRender(d)}if(d.conf.disable){this.disable(d)}return d},callAfterInit:function(a){this._detachEventFromItem(a.base)},disable:function(b){var a=b.base.lastChild;if(b.combo instanceof dhtmlXCombo){b.combo.disable()}if(!/\s?dhxrb_disable_text_style/i.test(a.className)){a.className+=" dhxrb_disable_text_style"}return true},enable:function(b){var a=b.base.lastChild;if(b.combo instanceof dhtmlXCombo){b.combo.enable()}if(/\s?dhxrb_disable_text_style/i.test(a.className)){a.className=a.className.replace(/\s?dhxrb_disable_text_style/i,"")}return true},remove:function(a){if(a.combo instanceof dhtmlXCombo){a.combo.unload();a.combo=null}},getValue:function(a){var b=null;if(a.combo instanceof dhtmlXCombo){b=a.combo.getSelectedValue()}return b},setValue:function(a,b,c){if(a.combo instanceof dhtmlXCombo){a.conf.callEvent=c;a.combo.setComboValue(b)}},setSkin:function(a,b){if(a.combo instanceof dhtmlXCombo){a.combo.setSkin(b)}}};dhtmlXRibbon.prototype.items.slider={render:function(a,e){var c,d,b={};d={base:a,id:e.id,type:e.type,conf:{text:"",text_pos:"right",size:150,vertical:false,min:0,max:99,value:0,step:1,margin:10,disabled:false,enableTooltip:false}};for(c in e){if(c=="id"||c=="onclick"||c=="type"){continue}d.conf[c]=e[c]}for(c in d.conf){if(c=="text"||c=="text_pos"||c=="isbig"){continue}b[c]=d.conf[c]}d.base.innerHTML="<center><div class='dhxrb_slider'></div></center><div class='dhxrb_label_button'>"+d.conf.text+"</div>";b.parent=d.base.firstChild.firstChild;d.slider=new dhtmlXSlider(b);if(typeof(this.afterRender)=="function"){this.afterRender(d)}if(d.conf.disable){this.disable(d)}d.slider.attachEvent("onChange",function(f){d._callHandler(d.id,[f]);d.callEvent("onValueChange",[d.id,f])});return d},callAfterInit:function(a){this._detachEventFromItem(a.base)},setSkin:function(a,b){if(a.slider instanceof dhtmlXSlider){a.slider.setSkin(b)}},disable:function(b){var a=b.base.childNodes[1];if(b.slider instanceof dhtmlXSlider){b.slider.disable()}if(!/\s?dhxrb_disable_text_style/i.test(a.className)){a.className+=" dhxrb_disable_text_style"}return true},enable:function(b){var a=b.base.childNodes[1];if(b.slider instanceof dhtmlXSlider){b.slider.enable()}if(/\s?dhxrb_disable_text_style/i.test(a.className)){a.className=a.className.replace(/\s?dhxrb_disable_text_style/i,"")}return true},remove:function(a){if(a.slider instanceof dhtmlXSlider){a.slider.unload();a.slider=null}},getValue:function(a){var b=null;if(a.slider instanceof dhtmlXSlider){b=a.slider.getValue()}return b},setValue:function(a,b){if(a.slider instanceof dhtmlXSlider){a.slider.setValue(b)}}};dhtmlXRibbon.prototype.items._extends=function(c,b){var a;for(a in b){c[a]=c[a]||b[a]}return c};dhtmlXRibbon.prototype._addNewLevel=function(c){var b,a;if(c.conf.mode=="rows"){b=c.contForItems.lastChild;if(b&&/dhxrb_block_rows/i.test(b.className)&&(b.childNodes.length<3)){a=document.createElement("div");a.className="dhxrb_block_row";b.appendChild(a)}else{b=document.createElement("div");b.className="dhxrb_block_rows";c.contForItems.appendChild(b);a=document.createElement("div");a.className="dhxrb_block_row";b.appendChild(a)}}else{var a=document.createElement("div");a.className="dhxrb_3rows_block";c.contForItems.appendChild(a)}};dhtmlXRibbon.prototype._attachEventForItem=function(a){if(typeof(window.addEventListener)=="function"){a.addEventListener("mouseover",this._doOnHighlight0,false);a.addEventListener("mouseout",this._doOffHighlight0,false);a.addEventListener("mousedown",this._doOnHighlight1,false);a.addEventListener("mouseup",this._doOffHighlight1,false);a.addEventListener("click",this._doOnClick,false)}else{a.attachEvent("onmouseover",this._doOnHighlight0);a.attachEvent("onmouseout",this._doOffHighlight0);a.attachEvent("onmousedown",this._doOnHighlight1);a.attachEvent("onmouseup",this._doOffHighlight1);a.attachEvent("onclick",this._doOnClick)}};dhtmlXRibbon.prototype._detachEventFromItem=function(a){if(typeof(window.addEventListener)=="function"){a.removeEventListener("mouseover",this._doOnHighlight0,false);a.removeEventListener("mouseout",this._doOffHighlight0,false);a.removeEventListener("mousedown",this._doOnHighlight1,false);a.removeEventListener("mouseup",this._doOffHighlight1,false);a.removeEventListener("click",this._doOnClick,false)}else{a.detachEvent("onmouseover",this._doOnHighlight0);a.detachEvent("onmouseout",this._doOffHighlight0);a.detachEvent("onmousedown",this._doOnHighlight1);a.detachEvent("onmouseup",this._doOffHighlight1);a.detachEvent("onclick",this._doOnClick)}};dhtmlXRibbon.prototype._attachEventsToInput=function(a){if(typeof(window.addEventListener)=="function"){a.addEventListener("focus",this._doOnFocus,false);a.addEventListener("blur",this._doOnBlur,false);a.addEventListener("change",this._doOnChange,false);a.addEventListener("keydown",this._doOnKeydown,false)}else{a.attachEvent("onfocus",this._doOnFocus);a.attachEvent("onblur",this._doOnBlur);a.attachEvent("onchange",this._doOnChange);a.attachEvent("onkeydown",this._doOnKeydown)}};dhtmlXRibbon.prototype._detachEventsFromInput=function(a){if(typeof(window.addEventListener)=="function"){a.removeEventListener("focus",this._doOnFocus,false);a.removeEventListener("blur",this._doOnBlur,false);a.removeEventListener("change",this._doOnChange,false);a.removeEventListener("keydown",this._doOnKeydown,false)}else{a.detachEvent("onfocus",this._doOnFocus);a.detachEvent("onblur",this._doOnBlur);a.detachEvent("onchange",this._doOnChange);a.detachEvent("onkeydown",this._doOnKeydown)}};dhtmlXRibbon.prototype._getContainerForSmallItem=function(c){var b=c.contForItems.lastChild,a=null;if(c.conf.mode=="rows"){if(b&&/\s?dhxrb_block_rows/i.test(b.className)){a=b.lastChild;if(!a){a=document.createElement("div");a.className="dhxrb_block_row";b.appendChild(a)}}else{b=document.createElement("div");b.className="dhxrb_block_rows";c.contForItems.appendChild(b);a=document.createElement("div");a.className="dhxrb_block_row";b.appendChild(a)}}else{if(b&&/dhxrb_3rows_block/i.test(b.className)&&(b.childNodes.length<3)){a=b}else{a=document.createElement("div");a.className="dhxrb_3rows_block";c.contForItems.appendChild(a)}}return a};dhtmlXRibbon.prototype._findItemByNode=function(a){while(a&&!a._dhx_ribbonId){a=a.parentNode}return a};dhtmlXRibbon.prototype._indexOf=function(a,d){var c,b;b=a.length;for(c=0;c<b;c++){if(a[c]==d){return c}}return -1};dhtmlXRibbon.prototype._removeItem=function(c){var a,d=-1,b=this._items[c.parentId];if(c.type=="group"){this._removeGroup(c);return}delete this._items[c.id];a=c.base.parentNode;this._detachEventFromItem(c.base);a.removeChild(c.base);if(b.type=="block"){if(a!=b.contForItems&&a.childNodes.length==0){a.parentNode.removeChild(a)}}else{if(b.type=="group"){dhtmlXRibbon.prototype.items.group.normalize(b)}}d=this._indexOf(b.childIds,c.id);if(d!=-1){b.childIds.splice(d,1)}if(this.items[c.type]&&(typeof(this.items[c.type].remove)=="function")){this.items[c.type].remove(c,this)}};dhtmlXRibbon.prototype._removeGroup=function(d){var b=[],e,c=this._items[d.parentId],a=d.base.parentNode;for(e in d.childIds){e=parseInt(e);b.push(this._items[d.childIds[e]])}for(e in b){e=parseInt(e);this._removeItem(b[e])}delete this._items[d.id];if(d.base.parentNode){a.removeChild(d.base)}if(a.childNodes.length==0){a.parentNode.removeChild(a)}e=this._indexOf(c.childIds,d.id);if(e!=-1){c.childIds.splice(e,1)}if(this.items[d.type]&&(typeof(this.items[d.type].remove)=="function")){this.items[d.type].remove(d)}};dhtmlXRibbon.prototype._removeBlock=function(d){var a=[],c,b;for(c in d.childIds){c=parseInt(c);a.push(this._items[d.childIds[c]])}for(c in a){c=parseInt(c);this._removeItem(a[c])}delete this._items[d.id];d.base.parentNode.removeChild(d.base);if(d.parentId){b=this._items[d.parentId]}else{b=this}c=this._indexOf(b.childIds,d.id);if(c!=-1){b.childIds.splice(c,1)}};dhtmlXRibbon.prototype._removeTab=function(b,a){var d=[],c;for(c in b.childIds){c=parseInt(c);d.push(this._items[b.childIds[c]])}for(c in d){c=parseInt(c);this._removeBlock(d[c])}delete this._items[b.id];c=this._indexOf(this.childIds,b.id);if(c!=-1){this.childIds.splice(c,1)}};dhtmlXRibbon.prototype._skinCollection={dhx_skyblue:true,dhx_web:true,dhx_terrace:true};dhtmlXRibbon.prototype._setSkinForItems=function(c){var a,b;for(a in this._items){b=this._items[a];b.conf.skin=c;if(dhtmlXRibbon.prototype.items[b.type]&&typeof(dhtmlXRibbon.prototype.items[b.type].setSkin)=="function"){dhtmlXRibbon.prototype.items[b.type].setSkin(b,c)}}b=undefined,a=undefined};dhtmlXRibbon.prototype._setBlockText=function(a,b){a.conf.text=b;a.contForText.innerHTML=b;if(!b&&(b!=0)&&a.contForText.parentNode){a.contForText.parentNode.removeChild(a.contForText)}else{if(!a.contForText.parentNode){if(a.conf.text_pos=="top"){a.base.insertBefore(a.contForText,a.contForItems)}else{a.base.appendChild(a.contForText)}}}};dhtmlXRibbon.prototype.hide=function(c){var b=this._items[c];if(this.items[b.type]&&(typeof(this.items[b.type].hide)=="function")){if(this.items[b.type].hide(b)!=true){return}}if(b.type=="tab"){return}else{if(!/\s?dhxrb_item_hide/i.test(b.base.className)){b.base.className+=" dhxrb_item_hide"}}var a=this._items[b.parentId];if(a&&this.items[a.type]&&(typeof(this.items[a.type].hideChild)=="function")){this.items[a.type].hideChild(a,b)}};dhtmlXRibbon.prototype.show=function(c){var b=this._items[c];if(this.items[b.type]&&(typeof(this.items[b.type].show)=="function")){if(this.items[b.type].show(b)!=true){return}}if(b.type=="tab"){return}else{if(/\s?dhxrb_item_hide/i.test(b.base.className)){b.base.className=b.base.className.replace(/\s?dhxrb_item_hide/i,"")}}var a=this._items[b.parentId];if(a&&this.items[a.type]&&(typeof(this.items[a.type].showChild)=="function")){this.items[a.type].showChild(a,b)}};dhtmlXRibbon.prototype.check=function(c,b){b=dhx4.s2b(b);var a=this._items[c];if(a&&!a.conf.checked&&typeof(this.items[a.type].check)=="function"){this.items[a.type].check(a);if(b){this.callEvent("onCheck",[a.id,a.conf.checked])}}};dhtmlXRibbon.prototype.uncheck=function(c,b){b=dhx4.s2b(b);var a=this._items[c];if(a&&a.conf.checked&&typeof(this.items[a.type].uncheck)=="function"){this.items[a.type].uncheck(a);if(b){this.callEvent("onCheck",[a.id,a.conf.checked])}}};dhtmlXRibbon.prototype.disable=function(d,b){var c=this._items[d],a;if(this.items[c.type]&&(typeof(this.items[c.type].disable)=="function")){if(this.items[c.type].disable(c)!=true){return}}if(c.type=="tab"){return}else{if(c.type=="block"||c.type=="group"){for(a in c.childIds){a=parseInt(a);this.disable(c.childIds[a])}}}if(!/\s?dhxrb_item_disable/i.test(c.base.className)){c.base.className+=" dhxrb_item_disable"}c.conf.disable=true};dhtmlXRibbon.prototype.enable=function(d,b){var c=this._items[d],a;if(this.items[c.type]&&(typeof(this.items[c.type].enable)=="function")){if(this.items[c.type].enable(c)!=true){return}}if(c.type=="tab"){return}else{if(c.type=="block"||c.type=="group"){for(a in c.childIds){a=parseInt(a);this.enable(c.childIds[a])}}}if(/\s?dhxrb_item_disable/i.test(c.base.className)){c.base.className=c.base.className.replace(/\s?dhxrb_item_disable/i,"")}c.conf.disable=false};dhtmlXRibbon.prototype.isEnabled=function(b){var a=this._items[b];if(this.items[a.type]&&typeof(this.items[a.type].isEnabled)=="function"){return this.items[a.type].isEnabled(a)}if(a.type=="tab"){return}else{return a.conf.disable!=true}};dhtmlXRibbon.prototype.isVisible=function(b){var a=this._items[b];if(this.items[a.type]&&(typeof(this.items[a.type].isVisible)=="function")){return this.items[a.type].isVisible(a)}if(a.type=="tab"){return}else{return !/\s?dhxrb_item_hide/i.test(a.base.className)}};dhtmlXRibbon.prototype.setItemState=function(d,b,c){b=dhx4.s2b(b);c=dhx4.s2b(c);var a=this._items[d];if(a&&(typeof(this.items[a.type].setState)=="function")){switch(a.type){case"buttonSegment":this.items[a.type].setState(a,this,c);break;default:this.items[a.type].setState(a,b,c)}}};dhtmlXRibbon.prototype.setIconPath=function(a){this.conf.icons_path=a};dhtmlXRibbon.prototype.removeItem=function(b){var a=this._items[b];switch(a.type){case"tab":break;case"block":this._removeBlock(a);break;case"group":this._removeGroup(a);break;default:this._removeItem(a)}};dhtmlXRibbon.prototype.setSkin=function(e){e=(typeof(e)=="string")?e.toLowerCase():"";if(this._skinCollection[e]!=true){return}var c,b=-1,a,d="dhtmlxribbon";c=this._base.className.match(/\S\w+/ig);if(c instanceof Array){for(a in this._skinCollection){if(b==-1){b=this._indexOf(c,d+"_"+a)}else{break}}b=(b==-1)?c.length:b}else{c=[];b=0}c[b]=d+"_"+e;this._base.className=c.join(" ");this.conf.skin=e;if(this._tabbar!=null){this._tabbar.setSkin(e)}this._setSkinForItems(e)};dhtmlXRibbon.prototype.tabs=function(a){if(this._tabbar instanceof dhtmlXTabBar){return this._tabbar.tabs(a)}else{return undefined}};dhtmlXRibbon.prototype.getItemType=function(b){var a=this._items[b];if(a){return a.type}else{return undefined}};dhtmlXRibbon.prototype.getValue=function(c){var a=this._items[c],b=undefined;if(a&&this.items[a.type]&&typeof(this.items[a.type].getValue)=="function"){b=this.items[a.type].getValue(a)}return b};dhtmlXRibbon.prototype.setValue=function(d,b,c){var a=this._items[d];c=(c===false?false:true);if(a&&this.items[a.type]&&typeof(this.items[a.type].setValue)=="function"){this.items[a.type].setValue(a,b,c)}};dhtmlXRibbon.prototype.getItemText=function(b){var a=this._items[b];if(!a){return null}else{if(a.type=="tab"){return this.tabs(a.id).getText()}else{if(a.type=="block"){return this.items.button.getText(a)}else{if(this.items[a.type]&&typeof(this.items[a.type].getText)=="function"){return this.items[a.type].getText(a)}else{return null}}}}};dhtmlXRibbon.prototype.setItemText=function(c,b){var a=this._items[c];if(!a){return}else{if(a.type=="tab"){this.tabs(a.id).setText(b)}else{if(a.type=="block"){this._setBlockText(a,b)}else{if(this.items[a.type]&&typeof(this.items[a.type].setText)=="function"){this.items[a.type].setText(a,b)}}}}};dhtmlXRibbon.prototype.setItemImage=function(c,a){var b=this._items[c];if(b!=null&&this.items[b.type]!=null&&typeof(this.items[b.type].setImage)=="function"){this.items[b.type].setImage(b,a)}};dhtmlXRibbon.prototype.setItemImageDis=function(c,a){var b=this._items[c];if(b!=null&&this.items[b.type]!=null&&typeof(this.items[b.type].setImageDis)=="function"){this.items[b.type].setImageDis(b,a)}};(function(){var a=dhtmlXRibbon.prototype.items;a.buttonTwoState=a._extends(a.buttonTwoState,a.button);a.buttonSelect=a._extends(a.buttonSelect,a.buttonTwoState);a.buttonSegment=a._extends(a.buttonSegment,a.buttonTwoState)})();if(typeof(window.dhtmlXCellObject)!="undefined"){dhtmlXCellObject.prototype._createNode_ribbon=function(e,b,d,a,c){if(typeof(c)!="undefined"){e=c}else{e=document.createElement("DIV");e.className="dhx_cell_ribbon_"+(this.conf.borders?"def":"no_borders");e.appendChild(document.createElement("DIV"))}this.cell.insertBefore(e,this.cell.childNodes[this.conf.idx.cont]);this.conf.ofs_nodes.t.ribbon=true;this._updateIdx();this._adjustCont(this._idd);return e};dhtmlXCellObject.prototype.attachRibbon=function(a){if(!(this.dataNodes.ribbon==null&&this.dataNodes.toolbar==null)){return}if(typeof(a)=="undefined"){a={}}if(typeof(a.skin)=="undefined"){a.skin=this.conf.skin}a.parent=this._attachObject("ribbon").firstChild;this.dataNodes.ribbon=new dhtmlXRibbon(a);var b=this;this.dataNodes.ribbon.attachEvent("_onHeightChanged",function(){b._adjustCont(b._idd)});this._adjustCont();a.parent=null;a=null;return this.dataNodes.ribbon};dhtmlXCellObject.prototype.detachRibbon=function(){if(!this.dataNodes.ribbon){return}this.dataNodes.ribbon.unload();this.dataNodes.ribbon=null;delete this.dataNodes.ribbon;this._detachObject("ribbon")};dhtmlXCellObject.prototype.showRibbon=function(){this._mtbShowHide("ribbon","")};dhtmlXCellObject.prototype.hideRibbon=function(){this._mtbShowHide("ribbon","none")};dhtmlXCellObject.prototype.getAttachedRibbon=function(){return this.dataNodes.ribbon}}function dhtmlXTabBar(b,e){var c=this;this.conf={skin:(window.dhx4.skin||(typeof(dhtmlx)!="undefined"?dhtmlx.skin:null)||window.dhx4.skinDetect("dhxtabbar")||"dhx_skyblue"),fullScreen:false,fullScreenResize:false,lastActive:null,closeButton:false,align:"left",tabsMode:(e=="bottom"?"bottom":"top"),contZone:true,transSpeed:"0.15s",arwMode:"always",baseOfs:{w:2,h:2},tabsOfs:1,tabsTop:0,autoload:{}};var d;if(b!=null&&typeof(b)=="object"&&typeof(b.tagName)=="undefined"){d=b.parent;if(typeof(b.skin)!="undefined"){this.conf.skin=b.skin}if(typeof(b.mode)!="undefined"){this.conf.tabsMode=(b.mode=="bottom"?"bottom":"top")}if(typeof(b.align)!="undefined"){this.conf.align=(b.align=="right"?"right":"left")}if(typeof(b.close_button)!="undefined"){this.conf.closeButton=window.dhx4.s2b(b.close_button)}if(typeof(b.content_zone)!="undefined"){this.conf.contZone=window.dhx4.s2b(b.content_zone)}if(typeof(b.xml)!="undefined"){this.conf.autoload.xml=b.xml}if(typeof(b.json)!="undefined"){this.conf.autoload.xml=b.json}if(typeof(b.tabs)!="undefined"){this.conf.autoload.tabs=b.tabs}if(typeof(b.onload)!="undefined"){this.conf.autoload.tabs=b.tabs}if(typeof(b.arrows_mode)!="undefined"){this.conf.autoload.arrows_mode=b.arrows_mode}}else{d=b}if(d==document.body){document.documentElement.className+=" dhxtabbar_fullscreen";document.body.className+=" dhxtabbar_fullscreen";this.conf.fullScreen=true;this.base=document.createElement("DIV");this.base.className="dhxtabbar_base_"+this.conf.skin;this.base.style.position="absolute";this.base.style.left=this.conf.baseOfs.w+"px";this.base.style.top=this.conf.baseOfs.h+"px";document.body.appendChild(this.base)}else{this.base=(typeof(d)=="string"?document.getElementById(d):d);d=null;this.base.className+=" dhxtabbar_base_"+this.conf.skin}if(this.base._ofs!=null&&this.base._ofs.t!=null){this.conf.tabsTop=this.base._ofs.t}this.tabsMode=document.createElement("DIV");this.tabsMode.className="dhxtabbar_tabs_"+this.conf.tabsMode;this.base.appendChild(this.tabsMode);this.tabsArea=document.createElement("DIV");this.tabsArea.className="dhxtabbar_tabs dhxtabbar_tabs_"+this.conf.tabsMode;this.tabsArea.innerHTML="<div class='dhxtabbar_tabs_ar_left'><div class='dhxtabbar_arrow_img'></div></div><div class='dhxtabbar_tabs_base'><div class='dhxtabbar_tabs_cont_"+this.conf.align+"'><div class='dhxtabbar_tabs_line'></div></div></div><div class='dhxtabbar_tabs_ar_right'><div class='dhxtabbar_arrow_img'></div></div>";this.tabsArea.style.top=(this.conf.tabsMode=="top"?this.conf.tabsTop+"px":"auto");this.tabsMode.appendChild(this.tabsArea);this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align]="0px";this.tabsArea.childNodes[0].onclick=function(){if(c.conf.align=="left"){c._moveTabs(1)}else{c._moveTabs(-1)}};this.tabsArea.childNodes[2].onclick=function(){if(c.conf.align=="left"){c._moveTabs(-1)}else{c._moveTabs(1)}};this._onTabsAreaClick=function(f){return this._callMainEvent("onTabClose",[f])};this.tabsArea.onclick=function(g){g=g||event;var f=(g.target||g.srcElement);while(f!=null){if(typeof(f._tabCloseId)!="undefined"){if(c._onTabsAreaClick(f._tabCloseId)!==true){return}c.t[f._tabCloseId].conf.remove=true;c._hideTab(f._tabCloseId);f=null}else{if(typeof(f._tabId)!="undefined"){c._doOnClick(f._tabId);f=null}}if(f!=null){f=f.parentNode;if(f==this){f=null}}}};this.tabsArea.onselectstart=function(f){f=f||event;if(f.preventDefault){f.preventDefault()}else{f.returnValue=false}};this._doOnClick=function(f){this.callEvent("onTabClick",[f,this.conf.lastActive]);if(this.t[f].conf.enabled){this._setTabActive(f)}};this.t={};this.addTab=function(f,m,h,k,j,n){if(typeof(n)!="boolean"){n=(this.conf.closeButton==true)}j=window.dhx4.s2b(j);var i=document.createElement("DIV");i.className="dhxtabbar_tab";i.innerHTML="<div class='dhxtabbar_tab_text"+(n?" dhxtabbar_tab_text_close":"")+"'>"+m+"</div>"+(n?"<div class='dhxtabbar_tab_close'></div>":"");i._tabId=f;if(n){i.childNodes[1]._tabCloseId=f}var g=this.tabsArea.childNodes[1].firstChild;if(k!=null&&k+1>0&&k+1<g.childNodes.length){g.insertBefore(i,g.childNodes[k+1])}else{g.appendChild(i)}var o=false;if(typeof(h)=="undefined"||h==null||h=="*"){h=this._getLabelWidth(m,n);o=true}else{h=parseInt(h)}i.style.width=h+"px";var l=new dhtmlXTabBarCell(f,this);this.tabsMode.appendChild(l.cell);this.t[f]={tab:i,cell:l,conf:{text:m,visible:true,active:false,enabled:true,close:n,width:h,autowidth:o}};g=l=null;if(j){this._setTabActive(f)}else{this._adjustCell(f)}if(this.conf.initSeq!=true&&this.conf.arwMode=="auto"){this.setSizes()}};this.setSizes=function(){if(this.conf.fullScreen){this.base.style.left=this.conf.baseOfs.w+"px";this.base.style.top=this.conf.baseOfs.h+"px";this.base.style.width=document.body.offsetWidth-this.conf.baseOfs.w*2+"px";this.base.style.height=document.body.offsetHeight-this.conf.baseOfs.h*2+"px"}if(this.conf.tabsAreaOfs==null){this.tabsArea.style.width=this.base.offsetWidth+"px";this.conf.tabsAreaOfs=parseInt(this.tabsArea.style.width)-this.tabsArea.offsetWidth}this.tabsArea.style.width=this.base.offsetWidth+this.conf.tabsAreaOfs+"px";this._adjustCell(this.conf.lastActive);this._adjustTabs(true)};this._adjustCell=function(j){if(!this.conf.contZone||j==null){return}var i=(this.conf.tabsMode=="top"?this.tabsArea.offsetHeight:0)+this.conf.tabsTop;var g=this.base.offsetHeight-this.tabsArea.offsetHeight-this.conf.tabsTop;var f=this.t[j].cell.dataType;if(this.conf.skin=="dhx_skyblue"&&(f=="layout"||f=="tabbar"||f=="acc")){if(this.conf.tabsMode=="top"){i=i-1}g=g+1}if(j!=this.conf.lastActive){i=-5000;this.t[j].cell.cell.style.visibility="hidden";this.t[j].cell.cell.style.zIndex=0}this.t[j].cell._setSize(0,i,this.base.offsetWidth,g)};this.setTabsMode=function(f){this.conf.tabsMode=(f=="bottom"?"bottom":"top");this.tabsMode.className="dhxtabbar_tabs_"+this.conf.tabsMode;this.tabsArea.className="dhxtabbar_tabs dhxtabbar_tabs_"+this.conf.tabsMode;this.tabsArea.style.top=(this.conf.tabsMode=="top"?this.conf.tabsTop+"px":"auto");this.setSizes()};this._tabCss=function(k,i){var f=this.t[k].conf.active;var j=!this.t[k].conf.enabled;var g=!this.t[k].conf.visible;return"dhxtabbar_tab"+(g?" dhxtabbar_tab_hidden":(f||j?" dhxtabbar_tab"+(f?"_actv":"")+(j?"_dis":""):""))};this._getLabelWidth=function(h,g){if(this.tabsTextTest==null){this.tabsTextTest=document.createElement("SPAN");this.tabsTextTest.className="dhxtabbar_tabs_text_test_"+this.conf.skin}document.body.appendChild(this.tabsTextTest);this.tabsTextTest.innerHTML=h;var f=this.tabsTextTest.offsetWidth;if(window.dhx4.isIE&&f==0){f=this.tabsTextTest.offsetWidth}f+=(this.conf.skin=="dhx_terrace"?44:35);f+=(g?(this.conf.skin=="dhx_terrace"?14:9):0);document.body.removeChild(this.tabsTextTest);return f};this._adjustTabs=function(i){if(this._checkArrows()==true||i==true){this.tabsArea.childNodes[1].style.left=this.tabsArea.childNodes[0].offsetWidth-1+"px";this.tabsArea.childNodes[1].style.width=Math.max(0,this.tabsArea.offsetWidth-this.tabsArea.childNodes[0].offsetWidth-this.tabsArea.childNodes[2].offsetWidth)+1+"px"}var l=this.tabsArea.childNodes[1];if(l.offsetWidth<5){l=null;return}var f=parseInt(l.childNodes[0].style[this.conf.align]);var h=null;for(var j=0;j<l.childNodes[0].childNodes.length;j++){var m=l.childNodes[0].childNodes[j]._tabId;if(m!=null&&this.t[m].conf.visible){var g=this.t[m].tab.offsetWidth-this.conf.tabsOfs;if(this.t[m].conf.active){if(f<0||l.offsetWidth<g){h={d:1,id:m}}else{if(f+g>l.offsetWidth){h={d:-1,id:m}}}}f+=g}}if(h!=null){this._moveTabs(h.d,h.id)}else{if(l.offsetWidth>f+1){l.childNodes[0].style[this.conf.align]=Math.min(0,parseInt(l.childNodes[0].style[this.conf.align])+(l.offsetWidth-f))+"px"}}l=h=null};this._moveTabs=function(s,k){var j=this.tabsArea.childNodes[1].childNodes[0];var o=0;var u=[];var w=null;for(var g=0;g<j.childNodes.length;g++){var h=j.childNodes[g]._tabId;if(h!=null&&this.t[h].conf.visible){u.push({id:h,w:this.t[h].tab.offsetWidth-this.conf.tabsOfs,ind:o});if(h==k){w=o}o++}}var v=parseInt(this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align]);var n=this.tabsArea.offsetWidth-this.tabsArea.childNodes[0].offsetWidth-this.tabsArea.childNodes[2].offsetWidth;var r=null;var m=null;for(var g=0;g<u.length;g++){u[g].x=v;if(r==null&&v>=0&&v+u[g].w>0){r=u[g]}if(v<n&&v+u[g].w<=n){m=u[g]}v+=u[g].w}if(w!=null){var y=u[w]}else{var y=null;if(s>0){if(r==null){if(u.length>0){y=u[u.length-1]}}else{if(r.ind>0&&u.length>=r.ind){y=u[r.ind-1]}}}else{if(m==null){if(u.length>0){y=u[0]}}else{if(u.length>m.ind){y=u[m.ind+1]}}}}if(y!=null){if(s>0){if(v<n){j.style[this.conf.align]=Math.min(0,parseInt(j.style[this.conf.align])+(n-v))+"px"}else{j.style[this.conf.align]=parseInt(j.style[this.conf.align])-y.x+"px"}}else{j.style[this.conf.align]=parseInt(j.style[this.conf.align])-y.x+n-y.w+"px"}}j=y=u=null};this._getNextVisible=function(g,f){return this._getNearVisible(g,f,"next")};this._getPrevVisible=function(g,f){return this._getNearVisible(g,f,"previous")};this._getFirstVisible=function(){return this._getNearVisible(null,false,"first")};this._getNearVisible=function(l,h,j){if(j=="first"){var i=this.tabsArea.childNodes[1].childNodes[0].childNodes[1];j="next"}else{if(l==null||this.t[l]==null){return(h?this._getFirstVisible():null)}var i=this.t[l].tab[j+"Sibling"]}var g=null;while(i!=null&&g==null){var f=i._tabId;if(f!=null&&g==null&&this.t[f].conf.visible){g=f}else{i=i[j+"Sibling"]}}i=null;return g};this._showTab=function(g,f){if(!this.t[g]||this.t[g].conf.visible||this.t[g].conf.transActv){return}if(this.conf.transProp!==false){this.t[g].conf.transActv=true;this.t[g].conf.transMode="show";this.t[g].conf.transProp=this.conf.transProp;this.t[g].conf.transActvId=(f?g:null);if(!this.t[g].conf.transEv){this.t[g].tab.addEventListener(this.conf.transEv,this._doOnTrEnd);this.t[g].conf.transEv=true}this.t[g].conf.visible=true;this.t[g].tab.className=this._tabCss(g);this.t[g].tab.style[this.conf.transProp]=this.conf.transValueWidth;this.t[g].tab.style.width=this.t[g].conf.width+"px"}else{this.t[g].conf.visible=true;this.t[g].tab.style.display="";if(f){this._setTabActive(g)}else{this._adjustTabs()}}};this._hideTab=function(k,f){if(!this.t[k]||!this.t[k].conf.visible||this.t[k].conf.transActv){return}var g=false;if(this.conf.lastActive==k){this.conf.lastActive=null;this.t[k].conf.active=false;this.t[k].tab.className=this._tabCss(k);g=true}var i=this._getPrevVisible(k);var h=this._getNextVisible(k);var j=(g&&f!==false?(f==true?null:f)||h||i:null);if(this.conf.transProp!==false){this.t[k].conf.transActv=true;this.t[k].conf.transMode="hide";this.t[k].conf.transProp=this.conf.transProp;this.t[k].conf.transActvId=j;this.t[k].conf.visible=false;if(!this.t[k].conf.transEv){this.t[k].tab.addEventListener(this.conf.transEv,this._doOnTrEnd);this.t[k].conf.transEv=true}this.t[k].tab.style.visibility="hidden";this.t[k].tab.className=c._tabCss(k);this.t[k].tab.style[this.conf.transProp]=this.conf.transValueWidth;this.t[k].tab.style.width="0px"}else{this.t[k].tab.style.display="none";this.t[k].conf.visible=false;if(this.conf.contZone){this.t[k].cell.cell.style.visibility="hidden";this.t[k].cell.cell.style.top="-5000px"}if(j!=null){this._setTabActive(j)}this._adjustTabs();if(this.t[k].conf.remove){this._removeTab(k)}}};this._isTabVisible=function(f){return(this.t[f].conf.visible==true)};this._doOnTrEnd=function(){var h=this._tabId;if(c.t[h]==null){return}var f=c.t[h];var g=f.conf.transActvId;if(f.conf.transMode=="hide"){if(f.conf.remove){c._removeTab(h)}else{f.tab.style[f.conf.transProp]="";if(c.conf.contZone){f.cell.cell.style.visibility="hidden";f.cell.cell.style.top="-5000px"}f.conf.transActv=false}}else{if(f.conf.transMode=="show"){f.tab.style[f.conf.transProp]="";f.tab.style.visibility="visible";f.conf.transMode=null;f.conf.transActv=false}}if(g!=null){c._setTabActive(g)}else{c._adjustTabs()}f=null};this.enableTabCloseButton=function(f){this.conf.closeButton=window.dhx4.s2b(f)};this.unload=function(){this.clearAll();this.t=null;if(this.conf.fullScreen){if(window.addEventListener){window.removeEventListener("resize",this._doOnResizeStart,false)}else{window.detachEvent("onresize",this._doOnResizeStart)}this._doOnResizeStart=null;this._doOnResizeEnd=null}if(this.tabsTextTest!=null){if(this.tabsTextTest.parentNode){this.tabsTextTest.parentNode.removeChild(this.tabsTextTest)}this.tabsTextTest=null}window.dhx4._eventable(this,"clear");window.dhx4._enableDataLoading(this,null,null,null,"clear");this.tabsArea.childNodes[0].onclick=null;this.tabsArea.childNodes[2].onclick=null;this.tabsArea.onclick=null;this.tabsArea.onselectstart=null;this.tabsArea.parentNode.removeChild(this.tabsArea);this.tabsArea=null;this.tabsMode.parentNode.removeChild(this.tabsMode);this.tabsMode=null;if(this.conf.fullScreen){this.base.parentNode.removeChild(this.base);document.documentElement.className=document.documentElement.className.replace("dhxtabbar_fullscreen","");document.body.className=document.body.className.replace("dhxtabbar_fullscreen","")}else{this.base.className=this.base.className.replace("dhxtabbar_base_"+this.conf.skin,"")}this.base=null;for(var f in this){this[f]=null}c=null};this.enableContentZone=function(f){this.conf.contZone=(f==true)};this.setSkin=function(g){this.base.className=this.base.className.replace(new RegExp("dhxtabbar_base_"+this.conf.skin),"dhxtabbar_base_"+g);this.conf.skin=g;if(this.tabsTextTest!=null){this.tabsTextTest.className="dhxtabbar_tabs_text_test_"+this.conf.skin}for(var f in this.t){this.t[f].cell._resetSizeState();if(this.t[f].conf.autowidth==true){this.t[f].conf.width=this._getLabelWidth(this.t[f].conf.text,this.t[f].conf.close);if(this.t[f].conf.visible){this.t[f].tab.style.width=this.t[f].conf.width+"px"}}}this.conf.tabsAreaOfs=null;this._fixTabsOfs();this.setSizes()};this.setAlign=function(f){f=(f=="left"?"left":"right");if(f==this.conf.align){this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align]="0px";return}if(this.conf.transProp!==false){this.tabsArea.childNodes[1].childNodes[0].style[this.conf.transProp]=""}this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align]="";this.conf.align=f;this.tabsArea.childNodes[1].childNodes[0].className="dhxtabbar_tabs_cont_"+this.conf.align;this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align]="0px";if(this.conf.transProp!==false){this.conf.transValuePos=this.conf.align+" "+this.conf.transSpeed;this.tabsArea.childNodes[1].childNodes[0].style[this.conf.transProp]=this.conf.transValuePos}};this._initObj=function(i){this.conf.initSeq=true;this.clearAll();var f=false;if(i.settings!=null){if(i.settings.skin!=null){this.setSkin(i.settings.skin)}if(i.settings.closeButton!=null){this.enableTabCloseButton(window.dhx4.s2b(i.settings.closeButton))}if(i.settings.align!=null){this.setAlign(i.settings.align)}if(i.settings.hrefmode=="ajax"||i.settings.hrefmode=="ajax-html"){f=true}}if(i.tabs!=null){for(var h=0;h<i.tabs.length;h++){var g=i.tabs[h];if(typeof(g.id)=="undefined"){g.id=window.dhx4.newId()}if(!isNaN(parseInt(g.width))){g.width=parseInt(g.width)}else{g.width=null}this.addTab(g.id,g.text||g.label||"",g.width,g.index,window.dhx4.s2b(g.selected)||window.dhx4.s2b(g.active),g.close);if(g.content!=null){this.cells(g.id).attachHTMLString(g.content)}if(g.href!=null){this.cells(g.id).attachURL(g.href,f)}if(typeof(g.enabled)!="undefined"&&window.dhx4.s2b(g.enabled)==false){this.tabs(g.id).disable()}else{if(typeof(g.disabled)!="undefined"&&window.dhx4.s2b(g.disabled)==true){this.tabs(g.id).disable()}}}}this.conf.initSeq=false;if(this.conf.arwMode=="auto"){this.setSizes()}};this._xmlToObj=function(j){var i={settings:{},tabs:[]};var f=j.getElementsByTagName("tabbar")[0];if(f!=null){for(var k in {skin:1,align:1,closeButton:1,hrefmode:1}){if(f.getAttribute(k)!=null){i.settings[k]=f.getAttribute(k)}}var m=f.getElementsByTagName("tab");for(var g=0;g<m.length;g++){var h={text:(m[g].firstChild.nodeValue||"")};for(var k in {id:1,width:1,close:1,selected:1,active:1,enabled:1,disabled:1,href:1}){if(m[g].getAttribute(k)!=null){h[k]=m[g].getAttribute(k)}}var n=m[g].getElementsByTagName("content")[0];if(n!=null){h.content="";for(var l=0;l<n.childNodes.length;l++){h.content+=(n.childNodes[l].nodeValue||"")}}i.tabs.push(h)}}return i};dhx4._enableDataLoading(this,"_initObj","_xmlToObj","tabbar",{struct:true});var a=window.dhx4.transDetect();this.conf.transProp=a.transProp;this.conf.transEv=a.transEv;this.conf.transValueWidth="width "+this.conf.transSpeed;a=null;if(this.conf.transProp!==false){this.conf.transValuePos=this.conf.align+" "+this.conf.transSpeed;this.tabsArea.childNodes[1].childNodes[0].style[this.conf.transProp]=this.conf.transValuePos}this._initFullScreenResize=function(){if(this.conf.fullScreenResize){return}this.conf.tmResize=null;this._doOnResizeStart=function(){window.clearTimeout(c.conf.tmResize);c.conf.tmResize=window.setTimeout(c._doOnResizeEnd,200)};this._doOnResizeEnd=function(){c.setSizes()};if(window.addEventListener){window.addEventListener("resize",this._doOnResizeStart,false)}else{window.attachEvent("onresize",this._doOnResizeStart)}this.conf.fullScreenResize=true};if(this.conf.fullScreen){this._initFullScreenResize()}this._callMainEvent=function(g,f){return this.callEvent(g,f)};window.dhx4._eventable(this);if(this.conf.autoload.json!=null){this.loadStruct(this.conf.autoload.json,this.conf.autoload.onload)}else{if(this.conf.autoload.xml!=null){this.loadStruct(this.conf.autoload.xml,this.conf.autoload.onload)}else{if(this.conf.autoload.tabs!=null){this.loadStruct({tabs:this.conf.autoload.tabs})}}}if(this.conf.autoload.arrows_mode!=null){this.setArrowsMode(this.conf.autoload.arrows_mode)}this._fixTabsOfs();this.setSizes();return this}dhtmlXTabBar.prototype._fixTabsOfs=function(){this.conf.tabsOfs=(this.conf.skin=="dhx_web"?0:1)};dhtmlXTabBar.prototype.cells=dhtmlXTabBar.prototype.tabs=function(a){if(this.t[a]){return this.t[a].cell}return null};dhtmlXTabBar.prototype.getAllTabs=function(){var c=[];for(var b in this.t){c.push(b)}return c};dhtmlXTabBar.prototype._setTabActive=function(b,a){if(!this.t[b]||!this.t[b].conf.visible||this.t[b].conf.active){return}if(typeof(a)=="undefined"){a=true}if(a==true&&this.callEvent("onSelect",[b,this.conf.lastActive])!==true){return}this.setTabInActive();this.t[b].conf.active=true;if(this.conf.contZone){this.t[b].cell.cell.style.visibility="visible";this.t[b].cell.cell.style.top="0px";this.t[b].cell.cell.style.zIndex=1}this.t[b].tab.className=this._tabCss(b);this.conf.lastActive=b;this.setSizes()};dhtmlXTabBar.prototype.setTabInActive=function(){if(this.conf.lastActive&&this.t[this.conf.lastActive]){this.t[this.conf.lastActive].conf.active=false;if(this.conf.contZone){this.t[this.conf.lastActive].cell.cell.style.visibility="hidden";this.t[this.conf.lastActive].cell.cell.style.top="-5000px";this.t[this.conf.lastActive].cell.cell.style.zIndex=0}this.t[this.conf.lastActive].tab.className=this._tabCss(this.conf.lastActive);this.conf.lastActive=null}};dhtmlXTabBar.prototype._isTabActive=function(a){return(a==this.conf.lastActive&&this.conf.lastActive!=null)};dhtmlXTabBar.prototype.getActiveTab=function(){return this.conf.lastActive};dhtmlXTabBar.prototype.goToNextTab=function(){var a=this._getNextVisible(this.conf.lastActive,true);if(a!=null){this._setTabActive(a)}};dhtmlXTabBar.prototype.goToPrevTab=function(){var a=this._getPrevVisible(this.conf.lastActive,true);if(a!=null){this._setTabActive(a)}};dhtmlXTabBar.prototype._enableTab=function(b,a){if(!this.t[b]||this.t[b].conf.enabled){return}this.t[b].conf.enabled=true;this.t[b].tab.className=this._tabCss(b);if(a==true){this._setTabActive(b)}};dhtmlXTabBar.prototype._disableTab=function(b,a){if(!this.t[b]||!this.t[b].conf.enabled){return}this.t[b].conf.enabled=false;this.t[b].tab.className=this._tabCss(b);if(a!==false&&this.conf.lastActive==b){if(a==true){a=this._getNextVisible(b)||this._getPrevVisible(b)}this._setTabActive(a)}};dhtmlXTabBar.prototype._isTabEnabled=function(a){return(this.t[a]!=null&&this.t[a].conf.enabled==true)};dhtmlXTabBar.prototype._setTabText=function(d,c,b){if(!this.t[d]){return}var a=false;if(typeof(b)=="undefined"||b==null){b=this._getLabelWidth(c,this.t[d].conf.close);a=true}this.t[d].tab.style.width=b+"px";this.t[d].tab.childNodes[0].innerHTML=c;this.t[d].conf.text=c;this.t[d].conf.width=b;this.t[d].conf.autowidth=a};dhtmlXTabBar.prototype._getTabText=function(a){if(!this.t[a]){return null}return this.t[a].conf.text};dhtmlXTabBar.prototype._removeTab=function(h,c,f){if(!this.t[h]){return}if(f!=true&&this.t[h].conf.remove!=true){this.t[h].conf.remove=true;this._hideTab(h,c);return}if(typeof(c)=="undefined"){c=true}var d=this._getNextVisible(h);var e=this._getPrevVisible(h);if(this.t[h].conf.transEv==true){this.t[h].tab.removeEventListener(this.conf.transEv,this._doOnTrEnd);this.t[h].conf.transEv=false}for(var b in this.t[h].conf){this.t[h].conf[b]=null}this.t[h].conf=null;delete this.t[h].conf;this.t[h].cell._unload();this.t[h].cell=null;this.t[h].tab.parentNode.removeChild(this.t[h].tab);this.t[h].tab=null;this.t[h]=null;delete this.t[h];if(this.conf.lastActive==h&&c!=false){this.conf.lastActive=null;var g=(c==true?(d||e||this._getFirstVisible()):c);if(g!=null){this._setTabActive(g)}}else{if(f!=true){this._adjustTabs()}}};dhtmlXTabBar.prototype.clearAll=function(){for(var b in this.t){this._removeTab(b,false,true)}this.tabsArea.childNodes[1].childNodes[0].style[this.conf.align]="0px"};dhtmlXTabBar.prototype.moveTab=function(c,a){if(!this.t[c]||a<0){return}a+=1;var b=this.tabsArea.childNodes[1].firstChild;if(b.childNodes[a]!=this.t[c].tab){b.removeChild(this.t[c].tab);if(a>=b.childNodes.length){b.appendChild(this.t[c].tab)}else{b.insertBefore(this.t[c].tab,b.childNodes[a])}}b=null};dhtmlXTabBar.prototype._getIndex=function(d){var a=-1;var c=this.tabsArea.childNodes[1].firstChild;for(var b=1;b<c.childNodes.length;b++){if(c.childNodes[b]._tabId==d){a=b-1}}c=null;return a};dhtmlXTabBar.prototype.getNumberOfTabs=function(d){var c=0;for(var b in this.t){c+=(d!=true?1:(this.t[b].conf.visible==true?1:0))}return c};dhtmlXTabBar.prototype.forEachCell=dhtmlXTabBar.prototype.forEachTab=function(c){for(var b in this.t){c.apply(window,[this.t[b].cell])}};dhtmlXTabBar.prototype.enableAutoReSize=function(){this._initFullScreenResize()};dhtmlXTabBar.prototype.setArrowsMode=function(a){a={auto:"auto",always:"always"}[String(a)];if(a==null||a==this.conf.mode){return}this.conf.arwMode=a;if(a=="always"){this.tabsArea.childNodes[0].className="dhxtabbar_tabs_ar_left";this.tabsArea.childNodes[2].className="dhxtabbar_tabs_ar_right"}this.setSizes()};dhtmlXTabBar.prototype._checkArrows=function(){var e=false;if(this.conf.arwMode=="auto"){var d=0;for(var c in this.t){d+=this.t[c].tab.offsetWidth}var b=this.tabsArea.childNodes[0];var f=this.tabsArea.childNodes[2];if(d>this.base.offsetWidth){if(b.className.search(/dhxtabbar_tabs_ar_hidden/)>=0){b.className=b.className.replace(/\s{0,}dhxtabbar_tabs_ar_hidden/,"");f.className=f.className.replace(/\s{0,}dhxtabbar_tabs_ar_hidden/,"");e=true}}else{if(b.className.search(/dhxtabbar_tabs_ar_hidden/)<1){b.className+=" dhxtabbar_tabs_ar_hidden";f.className+=" dhxtabbar_tabs_ar_hidden";e=true}}b=f=null}return e};window.dhtmlXTabBarCell=function(d,c){dhtmlXCellObject.apply(this,[d,"_tabbar"]);this.tabbar=c;this.conf.skin=this.tabbar.conf.skin;this.conf.tabbar_funcs={show:"_showTab",hide:"_hideTab",isVisible:"_isTabVisible",enable:"_enableTab",disable:"_disableTab",isEnabled:"_isTabEnabled",getIndex:"_getIndex",getText:"_getTabText",setText:"_setTabText",setActive:"_setTabActive",isActive:"_isTabActive",close:"_removeTab"};this._tabbarCall=function(a){return function(){var e=[this._idd];for(var f=0;f<arguments.length;f++){e.push(arguments[f])}return this.tabbar[a].apply(this.tabbar,e)}};for(var b in this.conf.tabbar_funcs){this[b]=this._tabbarCall(this.conf.tabbar_funcs[b])}this.attachEvent("_onCellUnload",function(){this.tabbar=null;for(var e in this.conf.tabbar_funcs){this[e]=null;this.conf.tabbar_funcs[e]=null}this.conf.tabbar_funcs=null});this.attachEvent("_onContentLoaded",function(){this.tabbar._callMainEvent("onContentLoaded",arguments);this.tabbar._callMainEvent("onTabContentLoaded",arguments)});this.attachEvent("_onContentAttach",function(){this.tabbar._adjustCell(this.tabbar.conf.lastActive)})};window.dhtmlXTabBarCell.prototype=new dhtmlXCellObject();dhtmlXCellObject.prototype.attachTabbar=function(a){if(typeof(window.dhtmlXLayoutCell)!="undefined"&&this instanceof dhtmlXLayoutCell){this._hideBorders()}if(typeof(window.dhtmlXPortalCell)!="undefined"&&this instanceof window.dhtmlXPortalCell){this.hideHeader(true);this._hideBorders()}if(typeof(a)=="string"){a={mode:a}}else{if(typeof(a)!="object"||a==null){a={}}}var b=document.createElement("DIV");b.style.width="100%";b.style.height="100%";b.style.position="relative";b.style.overflow="hidden";if(typeof(window.dhtmlXAccordionCell)!="undefined"&&(this instanceof window.dhtmlXAccordionCell)){b._ofs={t:-1}}this._attachObject(b);a.skin=this.conf.skin;a.parent=b;this.dataType="tabbar";this.dataObj=new dhtmlXTabBar(a);a.parent=b=null;a=null;this.callEvent("_onContentAttach",[]);return this.dataObj};function dhtmlXTabBarInitFromHTML(){var z=document.getElementsByTagName("div");for(var i=0;i<z.length;i++){if(z[i].className.indexOf("dhtmlxTabBar")!=-1){var conf={settings:{},tabs:[]};var n=z[i];var id=n.id;n.className="";var k=new Array();for(var j=0;j<n.childNodes.length;j++){if(n.childNodes[j].tagName&&n.childNodes[j].tagName!="!"){k[k.length]=n.childNodes[j]}}var skin=n.getAttribute("skin");if(skin!=null){conf.settings.skin=skin}var w=new dhtmlXTabBar({parent:id,mode:n.getAttribute("mode")});window[id]=w;acs=n.getAttribute("onbeforeinit");if(acs){eval(acs)}align=n.getAttribute("align");if(align){conf.settings.align=align}var cont={};for(var j=0;j<k.length;j++){var m=k[j];var tab={id:m.id,text:m.getAttribute("name"),width:m.getAttribute("width"),selected:m.getAttribute("selected"),active:m.getAttribute("active"),close:m.getAttribute("close")};var href=m.getAttribute("href");if(href){cont[m.id]={href:href}}else{cont[m.id]={cont:m}}conf.tabs.push(tab)}w.loadStruct(conf);for(var a in cont){if(cont[a].href){w.cells(a).attachURL(cont[a].href);cont[a].href=null}else{w.cells(a).attachObject(cont[a].cont);if(cont[a].cont.style.display=="none"){cont[a].cont.style.display=""}cont[a].cont=null}cont[a]=null}var selId=n.getAttribute("select");if(selId!=null){w.tabs(selId).setActive()}else{if(w.getActiveTab()==null){var v=w._getFirstVisible();if(v!=null){w.cells(v).setActive()}}}acs=n.getAttribute("oninit");if(acs){eval(acs)}}}if(typeof(window.addEventListener)=="function"){window.removeEventListener("load",dhtmlXTabBarInitFromHTML,false)}else{window.detachEvent("onload",dhtmlXTabBarInitFromHTML)}}if(typeof(window.addEventListener)=="function"){window.addEventListener("load",dhtmlXTabBarInitFromHTML,false)}else{window.attachEvent("onload",dhtmlXTabBarInitFromHTML)};